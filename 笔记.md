### **BEM** å‘½åè§„èŒƒ

Block__Element--modifile

å—ï¼Œå—ä¸­çš„å…ƒç´ åï¼Œå½“å‰ç±»ä¸»è¦æ˜¯ä»€ä¹ˆä¿®é¥°ä½œç”¨ï¼Ÿcolor?red?displayï¼Ÿ

### å¸¸è§çš„å—çº§å…ƒç´ ã€è¡Œå†…å…ƒç´ ã€è¡Œå†…å—å…ƒç´ 

ä¸€ã€å—çº§å…ƒç´  block

ç‰¹ç‚¹ï¼š
è‡ªåŠ¨æ¢è¡Œ
ç‹¬å ä¸€è¡Œ
å¯è®¾ç½®å®½é«˜
é»˜è®¤å®½åº¦ä¸ºçˆ¶å…ƒç´ çš„å®½åº¦
2.å¸¸è§å—çº§å…ƒç´ 
divã€pã€h1~h6ã€**ulã€ol**ã€dlã€**li**ã€ddã€tableã€hrã€blockquoteã€addressã€tableã€menuã€preï¼ŒHTML5æ–°å¢çš„headerã€sectionã€asideã€footerç­‰

form

3.æ³¨æ„
å—çº§å…ƒç´ å¯ä»¥åµŒå¥—ä»»æ„å…ƒç´ 
å—çº§æ–‡å­—å…ƒç´ ä¸­ä¸èƒ½æ”¾å…¥å…¶ä»–å—çº§å…ƒç´ ï¼Œæ¯”å¦‚ï¼š pä¸­ä¸è¦åµŒå¥—divã€pã€h



äºŒã€è¡Œå†…å…ƒç´  inline
1.ç‰¹ç‚¹
æ— æ³•è‡ªåŠ¨æ¢è¡Œ
ä¸€è¡Œå¯æ”¾å¤šä¸ª
ä¸å¯è®¾ç½®å®½é«˜
é»˜è®¤å®½åº¦æ˜¯æœ¬èº«å†…å®¹å®½åº¦
è¡Œå†…å…ƒç´ çš„padddingå¯ä»¥è®¾ç½®
marginåªèƒ½å¤Ÿè®¾ç½®æ°´å¹³æ–¹å‘çš„è¾¹è·ï¼Œå³ï¼šmargin-leftå’Œmargin-rightï¼Œè®¾ç½®margin-topå’Œmargin-bottomæ— æ•ˆ



2.å¸¸è§è¡Œå†…å…ƒç´ 
spanã€imgã€aã€lableã€inputã€abbrï¼ˆç¼©å†™ï¼‰ã€emï¼ˆå¼ºè°ƒï¼‰ã€bigã€citeï¼ˆå¼•ç”¨ï¼‰ã€iï¼ˆæ–œä½“ï¼‰ã€qï¼ˆçŸ­å¼•ç”¨ï¼‰ã€textareaã€selectã€smallã€subã€supï¼Œstrongã€uï¼ˆä¸‹åˆ’çº¿ï¼‰ã€buttonï¼ˆé»˜è®¤displayï¼šinline-blockï¼‰



ä¸‰ã€è¡Œå†…å—å…ƒç´  inline-block
1.ç‰¹ç‚¹
ç»¼åˆå—çº§å…ƒç´ ä¸è¡Œå†…å…ƒç´ çš„ç‰¹æ€§ï¼Œå¯è®¾å®½é«˜ï¼ˆé»˜è®¤æ˜¯å†…å®¹å®½é«˜ï¼‰ï¼Œä¹Ÿå¯ä»¥è®¾ç½®å†…å¤–è¾¹è·



2.å¸¸è§è¡Œå†…å—å…ƒç´ 
img ã€**input** ã€td
å››ã€æ ‡ç­¾ä¹‹é—´çš„è½¬æ¢
displayï¼šinlineï¼ˆè½¬ä¸ºè¡Œå†…å…ƒç´ ï¼‰/inline-blockï¼ˆè½¬ä¸ºè¡Œå†…å—å…ƒç´ ï¼‰/blockï¼ˆè½¬ä¸ºå—å…ƒç´ ï¼‰/noneï¼ˆéšè— ä¸æ˜¾ç¤ºï¼‰

æ³¨æ„ï¼šå½“å…ƒç´ æµ®åŠ¨ï¼ˆfloatï¼‰æ—¶ä¼šè½¬åŒ–æˆè¡Œå†…å—å…ƒç´ ç‰¹ç‚¹ã€‚


### SVGæ ‡ç­¾å­¦ä¹ 

pathç”Ÿæˆä»»æ„å½¢çŠ¶

### ç‚¹å‡»æœç´¢è¿‡æ¸¡ï¼Œæœç´¢å˜å¤§ï¼Œåˆ›ä½œä¸­å¿ƒæ¶ˆå¤±

- ç”¨ä¸€ä¸ªulåŒ…è£¹èµ·æ¥è¿™é‡Œé¢çš„ä¸¤ä¸ªliï¼›
- ulç»™å®šå®½åº¦å’Œé«˜åº¦ï¼Œç„¶åå’Œå³è¾¹çš„ä¸‰ä¸ªliä¸€èµ·å³æµ®åŠ¨èµ·æ¥ï¼›
- ulé‡Œé¢çš„ä¸¤ä¸ªliï¼Œä¸€ä¸ªå·¦æµ®åŠ¨ä¸€ä¸ªå³æµ®åŠ¨ï¼Œlié‡Œé¢çš„å†…å®¹å±…ä¸­ä½¿ç”¨flexå¸ƒå±€
- ç‚¹å‡»ä¹‹åï¼Œç¬¬ä¸€ä¸ªliå®½åº¦ï¼Œè¾¹æ¡†é€šè¿‡æ·»åŠ classNameå˜åŒ–ï¼Œå³è¾¹çš„lié€šè¿‡transform: translateX(200px)ç§»åŠ¨åˆ°å³è¾¹ï¼›
- ulæ·»åŠ overflow: hiddenéšè—åé¢çš„å‡ºå»çš„li

### ç–‘é—®ï¼Ÿå·²ç»åœ¨flexçš„å­ç›’å­ï¼Œå†å¼€å¯BFC

- å½“å‰å…ƒç´ å·²ç»flex: 1

- å³æµ®åŠ¨ä¸€ä¸ªç›’å­ï¼Œæµ®åŠ¨çš„ç›’å­å°±ä¼šè·‘å»å½“å‰ç›’å­ä¸‹æ–¹çš„æµ®åŠ¨æµï¼Œå› ä¸ºä½ è§„å®šå½“å‰çš„ç›’å­å 1

  ```html
  ä¸‹é¢çš„æƒ…å†µå…ˆè®©containerBè‡ªé€‚åº”
  <style>
      .containerA {
          display: flex;
      }
      .left {
          width: 100px;
      }
      .containerB {
          flex: 1;
      }
  </style>
  <div class="containerA">
      <div class="left">left</div>
      <div class="containerB">
      	<div class="middle">middle</div>
          <div class="right">right</div>
      </div>
  </div>
  
  æˆ‘æƒ³è¦ç»™containerBé‡Œé¢çš„middleè‡ªé€‚åº”ï¼Œç”¨BFCæ–¹æ³•æ˜¯æ— æ•ˆçš„
  çˆ¶å…ƒç´ æ˜¯flexå¸ƒå±€,å­å…ƒç´ çš„floatã€clearå’Œvertical-alignå±æ€§å°†ä¼šå¤±æ•ˆ
  <style>
      .right {
          float: right;
      }
      .middle {
          overflow: hidden;
      }
  </style>
  ä¸Šé¢çš„æ“ä½œæ— éæ˜¯æƒ³è®©middleè‡ªé€‚åº”ï¼Œåšä¸¤æ è‡ªé€‚åº”å°±å¯ä»¥äº†ï¼Œæœ‰æ—¶å€™å†™CSSå°±æ˜¯è½¬ä¸è¿‡å¼¯æ¥ï¼ï¼
  ```

  

### stickyå®šä½

å‚è§å¼ é‘«æ—­ï¼šhttps://www.zhangxinxu.com/wordpress/2018/12/css-position-sticky/

å•è¯stickyçš„ä¸­æ–‡æ„æ€æ˜¯â€œç²˜æ€§çš„â€ï¼Œ`position:sticky`è¡¨ç°ä¹Ÿç¬¦åˆè¿™ä¸ªç²˜æ€§çš„è¡¨ç°ã€‚åŸºæœ¬ä¸Šï¼Œå¯ä»¥çœ‹å‡ºæ˜¯`position:relative`å’Œ`position:fixed`çš„ç»“åˆä½“â€”â€”å½“å…ƒç´ åœ¨å±å¹•å†…ï¼Œè¡¨ç°ä¸ºrelativeï¼Œå°±è¦æ»šå‡ºæ˜¾ç¤ºå™¨å±å¹•çš„æ—¶å€™ï¼Œè¡¨ç°ä¸ºfixedã€‚

//zxx: position:stickyè¦æƒ³ç”Ÿæ•ˆï¼Œtopå±æ€§æˆ–åˆ™leftå±æ€§ï¼ˆçœ‹æ»šåŠ¨æ–¹å‘ï¼‰æ˜¯å¿…é¡»è¦æœ‰æ˜ç¡®çš„è®¡ç®—å€¼çš„ï¼Œå¦åˆ™fixedçš„è¡¨ç°ä¸ä¼šå‡ºç°ã€‚



```
fixed
```

å…ƒç´ ä¼šè¢«ç§»å‡ºæ­£å¸¸æ–‡æ¡£æµï¼Œå¹¶ä¸ä¸ºå…ƒç´ é¢„ç•™ç©ºé—´ï¼Œè€Œæ˜¯é€šè¿‡æŒ‡å®šå…ƒç´ ç›¸å¯¹äºå±å¹•è§†å£ï¼ˆviewportï¼‰çš„ä½ç½®æ¥æŒ‡å®šå…ƒç´ ä½ç½®ã€‚å…ƒç´ çš„ä½ç½®åœ¨å±å¹•æ»šåŠ¨æ—¶ä¸ä¼šæ”¹å˜ã€‚æ‰“å°æ—¶ï¼Œå…ƒç´ ä¼šå‡ºç°åœ¨çš„æ¯é¡µçš„å›ºå®šä½ç½®ã€‚`fixed` å±æ€§ä¼šåˆ›å»ºæ–°çš„å±‚å ä¸Šä¸‹æ–‡ã€‚å½“å…ƒç´ ç¥–å…ˆçš„ `transform`ã€`perspective`ã€`filter` æˆ– `backdrop-filter` å±æ€§é `none` æ—¶ï¼Œå®¹å™¨ç”±è§†å£æ”¹ä¸ºè¯¥ç¥–å…ˆã€‚

## è§£å†³ fixedå®šä½æ ¹æ®å…ƒç´ çš„é—®é¢˜

- çˆ¶å…ƒç´ ç»å¯¹å®šä½ï¼Œå†åŠ transition: all 0.3s linear; ç»™ä¸ªå®½åº¦width: xxpx, ç»å¯¹å®šä½åœ¨ä¸€ä¸ªä½ç½® absolute
- fixedå…ƒç´ ï¼Œtop: xxpx, rightä¸è¦ç»™å°±å¯ä»¥å®ç°ï¼›ä¸èƒ½ç»™margin!!!
- å®ç°å›ºå®šå®šä½æ»šåŠ¨ä»¥åä¸åŠ¨ï¼Œå¹¶ä¸”ç›¸å¯¹ä½ç½®è¿˜æ˜¯ä¸€ä¸ªå“åº”å¼çš„ä½ç½®ï¼Œä¼šéšç€é¡µé¢çš„å˜åŒ–è€Œå˜åŒ–ï¼ï¼ï¼

### useRef

### Manipulating the DOM with a ref 

Itâ€™s particularly common to use a ref to manipulate the [DOM.](https://developer.mozilla.org/en-US/docs/Web/API/HTML_DOM_API) React has built-in support for this.

First, declare a ref object with an initial value of `null`:

```
import { useRef } from 'react';



function MyComponent() {

  const inputRef = useRef(null);

  // ...
```

Then pass your ref object as the `ref` attribute to the JSX of the DOM node you want to manipulate:

```
  // ...

  return <input ref={inputRef} />;
```

After React creates the DOM node and puts it on the screen, React will set the `current` property of your ref object to that DOM node. Now you can access the `<input>`â€™s DOM node and call methods like [`focus()`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/focus):

```
  function handleClick() {

    inputRef.current.focus();

  }
```

### displayï¼šnoneä¸visibility: hidden

1. å‰è€…æ¶ˆå¤±åä¸å ç”¨æ ‡å‡†æµï¼Œåè€…å ç”¨--é‡ç»˜é‡æ’ï¼Ÿ

display:noneæ˜¯å½»åº•æ¶ˆå¤±ï¼Œ ä¸åœ¨æ–‡æ¡£æµä¸­å ä½ï¼Œ æµè§ˆå™¨ä¹Ÿä¸ä¼šè§£æè¯¥å…ƒç´ ï¼› **display:noneåˆ‡æ¢æ—¶ä¼šäº§ç”Ÿå›æµ**ã€‚ visibility:hiddenæ˜¯è§†è§‰ä¸Šæ¶ˆå¤±äº†ï¼Œ åœ¨æ–‡æ¡£æµä¸­å ä½ï¼Œæµè§ˆå™¨ä¼šè§£æè¯¥å…ƒç´ ï¼› **ä¸ä¼šäº§ç”Ÿå›æµ**

2. å‰è€…è¿‡æ¸¡æ— æ•ˆæœï¼Œåè€…å¯ä»¥åŠ è¿‡æ¸¡

3. visibility: hidden;æ˜¯å…·ç»§æ‰¿æ€§çš„ï¼Œ å¦‚æœçˆ¶çº§å…ƒç´ è®¾ç½®äº†visibility: hidden; é‚£ä¹ˆå­é›†å…ƒç´ ä¹Ÿä¼šçœ‹ä¸è§ã€‚

ä½†æ˜¯å¦‚æœå­é›†å…ƒç´ è®¾ç½®äº†visibility: visible; åˆ™è¯¥å­å…ƒç´ åˆä¼šæ˜¾ç¤ºå‡ºæ¥ è¿™ä¸ªå’Œdisplay:noneæœ‰ç€æœ¬è´¨çš„åŒºåˆ«

â€œ*visibility: hidden; çš„å…ƒç´ ä¸ä¼šè§¦å‘ç»‘å®šçš„äº‹ä»¶ã€‚* opacity:0; çš„å…ƒç´ ä¼šè§¦å‘ç»‘å®šçš„äº‹ä»¶

### å…¨éƒ¨--å‰ç«¯--åç«¯é€‰æ‹©æ¡†åœ¨æ»šåŠ¨çš„æ—¶å€™å“¦æ”¹å˜ä½ç½®çš„æ€è·¯

1. useRefè·å–åˆ°inputå’Œulçš„DOMå…ƒç´ 
2. getBoundingClientRectè·å–åˆ°inputå…ƒç´ ç›¸å¯¹äºclientçš„ä½ç½®
3. åˆ¤æ–­inputçš„yæ˜¯å¦å¤§äºulçš„é«˜åº¦ï¼Œå¦‚æœé«˜äºå°±æ”¾ä¸Šé¢ï¼Œå¦åˆ™æ”¾ä¸‹é¢
4. è§¦å‘äº‹ä»¶ä½¿ç”¨IntersectionObserver API---scrollè¿˜è¦èŠ‚æµ---æ€§èƒ½é—®é¢˜

### useEffecté’©å­---å¥‡æ€ªï¼Œç¬¬ä¸€éçš„æ—¶å€™è¿˜è®°å¾—ï¼Œè¿‡äº†åŠä¸ªæœˆå°±å¿˜è®°è¿™ä¸ªé’©å­äº†

effectï¼ˆå‰¯ä½œç”¨ï¼‰æ˜¯reactå‡½æ•°ç»„ä»¶ç”¨æ¥æ›¿ä»£ç”Ÿå‘½å‘¨æœŸçš„å‡½æ•°ã€‚ä½ å¯ä»¥æŠŠ `useEffect Hook` çœ‹åš `componentDidMount`ï¼Œ`componentDidUpdate` å’Œ `componentWillUnmount` è¿™ä¸‰ä¸ªå‡½æ•°çš„ç»„åˆã€‚

#### ç”¨æ³•

å®ƒçš„å‚æ•°å¦‚ä¸‹ï¼š `useEffect(callback[,[]])`

ç¬¬ä¸€ä¸ªå‚æ•°æ¥å—ä¸€ä¸ª`callback`å›è°ƒå‡½æ•°ï¼Œé‡Œé¢å¯ä»¥å†™æ‰§è¡Œä¸šåŠ¡ä»£ç 

ç¬¬äºŒä¸ªå‚æ•°å¯çœç•¥ï¼Œå®ƒæ¥å—ä¸€ä¸ªæ•°ç»„ï¼Œå¯ä»¥æ˜¯ç©ºæ•°ç»„ï¼Œä¹ŸåŒ…å«äº†`state`æ•°æ®

#### è¯´æ˜

1. å½“ä¸ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°æ—¶ï¼Œæ¯æ¬¡renderéƒ½ä¼šæ‰§è¡Œä¸€écallbackå‡½æ•°ï¼Œç›¸å½“äºåŒ…å«ç¬¬ä¸€érenderçš„`componentDidUpdate`

2. å½“ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ä¸”æ˜¯ç©ºæ•°ç»„æ—¶ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡renderæ‰ä¼šæ‰§è¡Œcallbackï¼Œç±»ä¼¼äº`componentDidMount`

3. ä¸ç®¡æ˜¯å¦ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ï¼Œåªè¦åœ¨`callback`ä¸­return ä¸€ä¸ªå‡½æ•°ï¼Œå°±ç›¸å½“äºå‘Šè¯‰reactæ­¤ç»„ä»¶æŒ‚æ‰ä¹‹å‰æ‰§è¡Œä»€ä¹ˆæ“ä½œï¼Œç±»ä¼¼äº`componentWillUnMount`

ç–‘é—®ï¼šuseEffectä¸ºä»€ä¹ˆä¼šæ‰§è¡Œä¸¤æ¬¡ï¼Ÿ

### è·¯ç”±

### BrowserRouter

> è¿™ä¸€ç§å¾ˆè‡ªç„¶ï¼Œæ¯”å¦‚ `/` å¯¹åº” `Homeé¡µ` ï¼Œ`/about` å¯¹åº” `About é¡µ`ï¼Œä½†æ˜¯`è¿™æ ·çš„è®¾è®¡éœ€è¦æœåŠ¡å™¨ç«¯æ¸²æŸ“`ï¼Œå› ä¸º`ç”¨æˆ·å¯èƒ½ç›´æ¥è®¿é—®ä»»ä½•ä¸€ä¸ª URLï¼ŒæœåŠ¡å™¨ç«¯å¿…é¡»èƒ½å¯¹ /çš„è®¿é—®è¿”å› HTMLï¼Œä¹Ÿè¦å¯¹ /aboutçš„è®¿é—®è¿”å› HTML`ã€‚BrowserRouteræ”¯æŒè¿™ç§URLã€‚ â‘ åŸºäºhistoryæ¨¡å¼ï¼šé¡µé¢è·³è½¬åŸç†æ˜¯ä½¿ç”¨äº†HTML5ä¸ºæµè§ˆå™¨å…¨å±€çš„historyå¯¹è±¡æ–°å¢äº†ä¸¤ä¸ªAPIï¼ŒåŒ…æ‹¬ history.pushStateã€history.replaceStateï¼›å’Œvue routerçš„historyæ¨¡å¼å®ç°ä¸€è‡´
>  â‘¡æ›´åŠ ä¼˜é›…ï¼š ç›´æ¥æ‹¼æ¥è·¯å¾„ï¼›å¦‚ï¼š[www.abc.com/xx](https://link.juejin.cn?target=http%3A%2F%2Fwww.abc.com%2Fxx)
>  â‘¢åç«¯éœ€åšè¯·æ±‚å¤„ç†ï¼š åˆ‡æ¢è·¯ç”±åï¼Œè¯·æ±‚æ¥å£è·¯å¾„ä¼šå‘ç”Ÿå˜åŒ–ï¼Œåç«¯éœ€è¦é…åˆï¼Œåšå¤„ç†

### HashRouter

> è¿™ä¸€ç§çœ‹èµ·æ¥ä¸è‡ªç„¶ï¼Œä½†æ˜¯å®ç°æ›´ç®€å•ã€‚`åªæœ‰ä¸€ä¸ªè·¯å¾„ /ï¼Œé€šè¿‡ URL åé¢çš„ # éƒ¨åˆ†æ¥å†³å®šè·¯ç”±`ï¼Œ/#/ å¯¹åº” Home é¡µï¼Œ/#/about å¯¹åº” About é¡µã€‚å› ä¸ºURLä¸­#ä¹‹åçš„éƒ¨åˆ†æ˜¯ä¸ä¼šå‘é€ç»™æœåŠ¡å™¨çš„ï¼Œæ‰€ä»¥ï¼Œ`æ— è®ºå“ªä¸ª URLï¼Œæœ€åéƒ½æ˜¯è®¿é—®æœåŠ¡å™¨çš„ / è·¯å¾„ï¼ŒæœåŠ¡å™¨ä¹Ÿåªéœ€è¦è¿”å›åŒæ ·ä¸€ä»½ HTML`å°±å¯ä»¥ï¼Œ`ç„¶åç”±æµè§ˆå™¨ç«¯è§£æ # åçš„éƒ¨åˆ†ï¼Œå®Œæˆæµè§ˆå™¨ç«¯æ¸²æŸ“`ã€‚HashRouteræ”¯æŒè¿™ç§URLã€‚
>  â‘ **åŸºäºhashæ¨¡å¼**ï¼šé¡µé¢è·³è½¬åŸç†æ˜¯ä½¿ç”¨äº†location.hashã€location.replaceï¼›å’Œ[vue](https://link.juejin.cn?target=https%3A%2F%2Fso.csdn.net%2Fso%2Fsearch%3Ffrom%3Dpc_blog_highlight%26q%3Dvue) routerçš„hashæ¨¡å¼å®ç°ä¸€è‡´
>  â‘¡**æ¯”è¾ƒä¸‘**ï¼šåœ¨åŸŸååï¼Œå…ˆæ‹¼æ¥/#ï¼Œå†æ‹¼æ¥è·¯å¾„ï¼›ä¹Ÿå°±æ˜¯åˆ©ç”¨é”šç‚¹ï¼Œå®ç°è·¯ç”±çš„è·³è½¬ï¼›å¦‚ï¼š[www.abc.com/#/xx](https://link.juejin.cn?target=http%3A%2F%2Fwww.abc.com%2F%23%2Fxx)

## ç–‘é—®ï¼šinputå¤±å»ç„¦ç‚¹çš„æ—¶å€™ï¼Œvisibilityä¸ºhiddenï¼Œæ‹¿ä¸åˆ°ulé‡Œé¢çš„å†…å®¹

ç‚¹å‡»lié‡Œé¢çš„aï¼Œè§¦å‘äº‹ä»¶ï¼Œaçš„ç‚¹å‡»åè§¦å‘ï¼Œè§¦å‘çš„æ—¶å€™éƒ½æ‹¿ä¸åˆ°ä»»ä½•å†…å®¹äº†

**å› ä¸ºinputå…ˆè§¦å‘å¤±å»ç„¦ç‚¹äº‹ä»¶ï¼Œç„¶åaå·²ç»è¢«è®¾ç½®ä¸ºvisibility: hiddenäº†ï¼Œè¿™æ—¶å€™aä¸èƒ½å¤Ÿè§¦å‘ç‚¹å‡»äº‹ä»¶ï¼Œæ‰€ä»¥æ¢ä¸ºopcityæ§åˆ¶å…ƒç´ çš„æ˜¾ç¤ºå’Œéšè—ï¼Œopcityï¼š0çš„å…ƒç´ èƒ½å¤Ÿè§¦å‘ç‚¹å‡»äº‹ä»¶**ã€‚

ä½†æ˜¯opacityï¼š 0æœ¬èº«åœ¨DOMä¸­ï¼Œéšè—çš„æ—¶å€™ä¹Ÿä¼šè§¦å‘äº‹ä»¶ï¼ï¼ï¼

å°†éšè—ä¸‹æ‹‰èœå•çš„å‡½æ•°å»¶è¿Ÿè§¦å‘ï¼Œè§£å†³é—®é¢˜

```
  /* éšè—ä¸‹æ‹‰èœå• */
  const hiddenEle = () => {
    setTimeout(() => {
      setIsDisplay(false)
    }, 100)
  }
```

ä¸ºä»€ä¹ˆå¯ä»¥è§£å†³ï¼Ÿaå»¶è¿Ÿéšè—ï¼Œè¿™æ—¶å€™æ‹¿åˆ°äº†açš„ç‚¹å‡»äº‹ä»¶ä¹‹åaæ‰æ¶ˆå¤±ã€‚

é™¤äº†è¿™ç§æ–¹æ³•è¿˜æœ‰ä»€ä¹ˆèƒ½å¤Ÿä¿è¯aç‚¹å‡»è§¦å‘æ’åœ¨hiddenä¹‹å

## ç–‘é—®ï¼šåˆ›ä½œä¸­å¿ƒçš„ä¸‹æ‹‰èœå•å®šä½åœ¨é‚£ä¸ªä½ç½®æ€ä¹ˆå®ç°

ä¹Ÿå³ï¼šä¸æ˜¯çˆ¶å­å…³ç³»çš„ä¸¤ä¸ªç›’å­çš„å®šä½å¦‚ä½•å®ç°é…åˆï¼Ÿä¸èƒ½ç»å¯¹å®šä½å’Œç›¸å¯¹å®šä½é…åˆçš„æ—¶å€™ç”¨jså»å¤„ç†ï¼ï¼

ï¼ï¼ï¼ï¼ç»å¯¹å®šä½çš„ç›’å­è„±ç¦»æ ‡å‡†æµå¹¶ä¸”ä¸ä¼šå½±å“ä»»æ„çš„ç›’å­ï¼Œä½ç½®è·Ÿéšç€çˆ¶å…ƒç´ çš„ä½ç½®èµ°ï¼Œæ‰€ä»¥ä½¿ç”¨ç»å¯¹å®šä½ï¼ï¼ï¼

### Viewport

åœ¨ç”µè„‘å›¾å½¢å­¦é‡Œé¢ï¼Œè§†å£ä»£è¡¨äº†ä¸€ä¸ªå¯çœ‹è§çš„å¤šè¾¹å½¢åŒºåŸŸï¼ˆé€šå¸¸æ¥è¯´æ˜¯çŸ©å½¢ï¼‰ã€‚åœ¨æµè§ˆå™¨èŒƒç•´é‡Œï¼Œå®ƒä»£è¡¨çš„æ˜¯æµè§ˆå™¨ä¸­ç½‘ç«™å¯è§å†…å®¹çš„éƒ¨åˆ†ã€‚è§†å£å¤–çš„å†…å®¹åœ¨è¢«æ»šåŠ¨è¿›æ¥å‰éƒ½æ˜¯ä¸å¯è§çš„ã€‚

è§†å£å½“å‰å¯è§çš„éƒ¨åˆ†å«åš**å¯è§†è§†å£**ï¼ˆvisual viewportï¼‰ã€‚å¯è§†è§†å£å¯èƒ½ä¼šæ¯”**å¸ƒå±€è§†å£**ï¼ˆlayout viewportï¼‰æ›´å°ï¼Œå› ä¸ºå½“ç”¨æˆ·ç¼©å°æµè§ˆå™¨ç¼©æ”¾æ¯”ä¾‹æ—¶ï¼Œ**å¸ƒå±€è§†å£ä¸å˜ï¼Œè€Œå¯è§†è§†å£å˜å°äº†**ã€‚

### Element.getBoundingClientRect()

è¿”å›å€¼æ˜¯ä¸€ä¸ª [`DOMRect`](https://developer.mozilla.org/zh-CN/docs/Web/API/DOMRect) å¯¹è±¡ï¼Œæ˜¯åŒ…å«æ•´ä¸ªå…ƒç´ çš„æœ€å°çŸ©å½¢ï¼ˆåŒ…æ‹¬ `padding` å’Œ `border-width`ï¼‰ã€‚è¯¥å¯¹è±¡ä½¿ç”¨ `left`ã€`top`ã€`right`ã€`bottom`ã€`x`ã€`y`ã€`width` å’Œ `height` è¿™å‡ ä¸ªä»¥åƒç´ ä¸ºå•ä½çš„åªè¯»å±æ€§æè¿°æ•´ä¸ªçŸ©å½¢çš„ä½ç½®å’Œå¤§å°ã€‚é™¤äº† `width` å’Œ `height` ä»¥å¤–çš„å±æ€§æ˜¯ç›¸å¯¹äºè§†å›¾çª—å£çš„å·¦ä¸Šè§’æ¥è®¡ç®—çš„ã€‚

å°±æ˜¯ç›¸å¯¹äºæ•´ä¸ªæµè§ˆå™¨çš„å·¦ä¸Šè§’

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    * {
      margin: 0;
      padding: 0;
    }
    body {
      height: 5000px;
    }
    p {
      margin-left: 1000px;
      background-color: yellow;
      width: 100px;
    }
    div {
      background-color: skyblue;
      width: 100px;
      height: 100px;
      position: fixed;
      /* right: 100px; */
    }
  </style>
</head>
<body>
  <p>789</p>
  <div>123456789</div>
  <script>
    const div =document.querySelector('div')
    const p = document.querySelector('p')
    console.log(div.getBoundingClientRect().right)
    console.log(document.body.clientWidth)
    div.style.right = document.body.clientWidth - p.getBoundingClientRect().right + 'px'
  </script>
</body>
</html>
```



## ç–‘é—®ï¼šèƒ½å¦ç”¨stickyå®ç°æ»šåŠ¨åå›ºå®šå®šä½çš„æ•ˆæœï¼Ÿ

```
fixed
```

å…ƒç´ ä¼šè¢«ç§»å‡ºæ­£å¸¸æ–‡æ¡£æµï¼Œå¹¶ä¸ä¸ºå…ƒç´ é¢„ç•™ç©ºé—´ï¼Œè€Œæ˜¯é€šè¿‡æŒ‡å®šå…ƒç´ ç›¸å¯¹äºå±å¹•è§†å£ï¼ˆviewportï¼‰çš„ä½ç½®æ¥æŒ‡å®šå…ƒç´ ä½ç½®ã€‚å…ƒç´ çš„ä½ç½®åœ¨å±å¹•æ»šåŠ¨æ—¶ä¸ä¼šæ”¹å˜ã€‚æ‰“å°æ—¶ï¼Œå…ƒç´ ä¼šå‡ºç°åœ¨çš„æ¯é¡µçš„å›ºå®šä½ç½®ã€‚`fixed` å±æ€§ä¼šåˆ›å»ºæ–°çš„å±‚å ä¸Šä¸‹æ–‡ã€‚å½“å…ƒç´ ç¥–å…ˆçš„ `transform`ã€`perspective`ã€`filter` æˆ– `backdrop-filter` å±æ€§é `none` æ—¶ï¼Œå®¹å™¨ç”±è§†å£æ”¹ä¸ºè¯¥ç¥–å…ˆã€‚

```
sticky
```

å…ƒç´ æ ¹æ®æ­£å¸¸æ–‡æ¡£æµè¿›è¡Œå®šä½ï¼Œç„¶åç›¸å¯¹å®ƒçš„*æœ€è¿‘æ»šåŠ¨ç¥–å…ˆ*ï¼ˆnearest scrolling ancestorï¼‰å’Œ [containing block](https://developer.mozilla.org/zh-CN/docs/Web/CSS/Containing_block)ï¼ˆæœ€è¿‘å—çº§ç¥–å…ˆ nearest block-level ancestorï¼‰ï¼ŒåŒ…æ‹¬ table-related å…ƒç´ ï¼ŒåŸºäº `top`ã€`right`ã€`bottom` å’Œ `left` çš„å€¼è¿›è¡Œåç§»ã€‚åç§»å€¼ä¸ä¼šå½±å“ä»»ä½•å…¶ä»–å…ƒç´ çš„ä½ç½®ã€‚ è¯¥å€¼æ€»æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„[å±‚å ä¸Šä¸‹æ–‡](https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context)ï¼ˆstacking contextï¼‰ã€‚æ³¨æ„ï¼Œä¸€ä¸ª sticky å…ƒç´ ä¼šâ€œå›ºå®šâ€åœ¨ç¦»å®ƒæœ€è¿‘çš„ä¸€ä¸ªæ‹¥æœ‰â€œæ»šåŠ¨æœºåˆ¶â€çš„ç¥–å…ˆä¸Šï¼ˆå½“è¯¥ç¥–å…ˆçš„ `overflow` æ˜¯ `hidden`ã€`scroll`ã€`auto` æˆ– `overlay` æ—¶ï¼‰ï¼Œå³ä¾¿è¿™ä¸ªç¥–å…ˆä¸æ˜¯æœ€è¿‘çš„çœŸå®å¯æ»šåŠ¨ç¥–å…ˆã€‚è¿™æœ‰æ•ˆåœ°æŠ‘åˆ¶äº†ä»»ä½•â€œstickyâ€è¡Œä¸ºï¼ˆè¯¦æƒ…è§ [Github issue on W3C CSSWG](https://github.com/w3c/csswg-drafts/issues/865)ï¼‰ã€‚

## React-routeré…ç½®

```react
import { createBrowserRouter, Navigate } from "react-router-dom";
import App from '../App'
import HomeMainContent from "../common/homeMainContent";

const router = createBrowserRouter([
  {
    path: '/',
    element: <App></App>,
    children: [
      {
        path: '',
        element: <HomeMainContent></HomeMainContent>
      },
      {
        path: '/recommended',
        element: <HomeMainContent></HomeMainContent>
      },
      {
        path: '/backend',
        element: <HomeMainContent></HomeMainContent>
      }
    ]
  }
])

export default router
```

æ€ä¹ˆè®©æ ¹è·¯å¾„åŒ¹é…APPæ˜¾ç¤ºçš„æ—¶å€™åŒ…å«è‡ªå·±çš„å­ç»„ä»¶ï¼Ÿè®©æ ¹è·¯å¾„çš„æœ‰ä¸€ä¸ªç©ºè·¯å¾„åŒ¹é…å°±å¯ä»¥äº†ï¼ï¼ï¼

## ç–‘é—®ï¼šæ€ä¹ˆå°†é¼ æ ‡ç»è¿‡çš„æ—¶å€™èœå•å˜è‰²å°è£…ä¸ºä¸€ä¸ªhook





## è§£å†³ï¼šOutLetç»„ä»¶æ‰€åœ¨çš„çˆ¶ç»„ä»¶éœ€è¦ä¼ é€’æ•°æ®ç»™OutLetè·³è½¬åçš„ç»„ä»¶ï¼Œæ€ä¹ˆä¼ é€’ï¼Ÿ

ä½¿ç”¨useContext-----ç±»ä¼¼Vue3çš„ä¾èµ–æ³¨å…¥

```
1.é¦–å…ˆï¼Œä½ éœ€è¦åˆ›å»ºè¿™ä¸ª contextï¼Œå¹¶ å°†å…¶ä»ä¸€ä¸ªæ–‡ä»¶ä¸­å¯¼å‡ºï¼Œè¿™æ ·ä½ çš„ç»„ä»¶æ‰å¯ä»¥ä½¿ç”¨å®ƒï¼š
import { createContext } from 'react';

export const LevelContext = createContext(1);

2.ä» React ä¸­å¼•å…¥ useContext Hook ä»¥åŠä½ åˆšåˆšåˆ›å»ºçš„ context:
import { useContext } from 'react';
import { LevelContext } from './LevelContext.js';

export default function Heading({ children }) {
  const level = useContext(LevelContext);
  // ...
}

3.æŠŠå®ƒä»¬ç”¨ context provider åŒ…è£¹èµ·æ¥  ä»¥æä¾› LevelContext ç»™å®ƒä»¬ï¼š
import { LevelContext } from './LevelContext.js';

export default function Section({ level, children }) {
  return (
    <section className="section">
      <LevelContext.Provider value={level}>
        {children}
      </LevelContext.Provider>
    </section>
  );
}
```

## CSSå¤´åƒå‰ªè£

```css
.pinscomment__img--header {
  width: 4rem;
  height: 4rem;
  border-radius: 50%;
}
```

## é‡ç‚¹ï¼šå¤„ç†æ–‡å­—æº¢å‡ºéšè—---åœ¨flexå¸ƒå±€æ¨¡å¼å†…çš„pï¼Œæ–‡å­—åå¤šä½™æ˜¾ç¤ºçœç•¥å·

çˆ¶ç›’å­è®¾ç½®ï¼š

å› ä¸ºä¹‹å‰white-space: nowrapè®©æ–‡å­—å¼ºåˆ¶åœ¨ä¸€è¡Œæ˜¾ç¤ºçš„æ—¶å€™ï¼Œflexå¸ƒå±€ä¼šè‡ªåŠ¨å˜å¤§è‡ªå·±å½“å‰æ‰€åœ¨çš„ç›’å­ï¼Œå¯¼è‡´å¸ƒå±€é”™è¯¯

```
white-space: nowrap;  // æ‰€æœ‰çš„ç©ºæ ¼éƒ½ä¸æ¢è¡Œ--å¼ºåˆ¶ä¸€è¡Œæ˜¾ç¤ºï¼Œæ¢è¡Œç¬¦ä¹Ÿä¼šè¢«webè§£é‡Šä¸ºç©ºæ ¼
overflow: hidden;  // æº¢å‡ºéšè—
text-overflow: hidden;  // æ–‡å­—æº¢å‡ºçš„æ—¶å€™ä½¿ç”¨çœç•¥å·è£…é¥°
```

è¿™æ ·æ²¡æœ‰å¼ºåˆ¶åœ¨ä¸€è¡Œæ˜¾ç¤ºï¼Œå¸ƒå±€æµä¼šè‡ªåŠ¨æµä¸‹å»ä»¥é€‚åº”é¡µé¢å˜åŒ–

```
font-size: 13px;
line-height: 22px;
display: -webkit-box;  // boxç›’å­---ç›’å­çš„é«˜åº¦ç”±è¡Œé«˜ä¹˜ä»¥å®é™…çš„è¡Œæ•°å†³å®š
overflow: hidden;
text-overflow: ellipsis;  // çœç•¥
-webkit-box-orient: vertical;
-webkit-line-clamp: 1;  // å°†æ–‡æœ¬çš„å†…å®¹é™åˆ¶ä¸ºæŒ‡å®šçš„è¡Œæ•°ï¼Œæ˜¾ç¤ºä¸ºæŒ‡å®šçš„è¡Œæ•°ä¹‹åè¿˜ä¼šæ˜¾ç¤ºçœç•¥å·ï¼Œæ‰€ä»¥text-overflowå¯ä»¥çœç•¥äº†
```

**`-webkit-line-clamp`** CSS å±æ€§å¯ä»¥æŠŠ[å—å®¹å™¨](https://developer.mozilla.org/zh-CN/docs/Glossary/Block)ä¸­çš„å†…å®¹é™åˆ¶ä¸ºæŒ‡å®šçš„è¡Œæ•°ã€‚

å®ƒåªæœ‰åœ¨ [`display`](https://developer.mozilla.org/zh-CN/docs/Web/CSS/display) å±æ€§è®¾ç½®æˆ `-webkit-box` æˆ–è€… `-webkit-inline-box` å¹¶ä¸” [`box-orient`](https://developer.mozilla.org/zh-CN/docs/Web/CSS/box-orient) å±æ€§è®¾ç½®æˆ `vertical`æ—¶æ‰æœ‰æ•ˆæœã€‚

åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä¹Ÿéœ€è¦è®¾ç½® [`overflow`](https://developer.mozilla.org/zh-CN/docs/Web/CSS/overflow) å±æ€§ä¸º `hidden`ï¼Œå¦åˆ™ï¼Œé‡Œé¢çš„å†…å®¹ä¸ä¼šè¢«è£å‡ï¼Œå¹¶ä¸”**åœ¨å†…å®¹æ˜¾ç¤ºä¸ºæŒ‡å®šè¡Œæ•°åè¿˜ä¼šæ˜¾ç¤ºçœç•¥å·**ã€‚

## CSSå®ç°ä¸‰è§’å½¢

ä¸€ä¸ªç›’å­ä¸‰ä¸ªè¾¹æ¡†è®¾ç½®

```
border: 2px solid transparent;
```

éœ€è¦ä¸‰è§’çš„é‚£ä¸ªåæ–¹å‘è®¾ç½®

```
border: 2px solid #ccc;
```

## Homeä¸»é¡µè·å–æ–‡ç« åˆ—è¡¨å¯ä»¥ç”¨routerçš„loaderæ¥åš

## articalé¡µé¢é€šè¿‡urlParamsè·å–æ–‡ç« idæ‹¿æ–‡ç« æ•°æ®ä¹Ÿæ˜¯é€šè¿‡loaderæ¥åš

loaderåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ

1. å½“å‰è·¯ç”±è·³è½¬åˆ°çš„ç›®æ ‡é¡µé¢å†™ä¸€ä¸ªloaderå‡½æ•°ï¼Œå‡½æ•°å‚æ•°ä½ç½®èƒ½æ‹¿åˆ°paramså‚æ•°
2. loaderé‡Œé¢æ‹¿åˆ°paramså‚æ•°---å»åšè¿›ä¸€æ­¥çš„å¤„ç†ï¼Œå¤„ç†ä»¥åæœ‰ä¸€ä¸ªè¿”å›å€¼
3. åœ¨è·¯ç”±é…ç½®jsæ–‡ä»¶é‡Œé¢å£°æ˜loaderä¸ºåœ¨ç»„ä»¶é‡Œé¢å†™çš„loader
4. ç»„ä»¶ç”Ÿæˆçš„æ—¶å€™ä½¿ç”¨useLoaderData() APIï¼Œè¿”å›çš„å‚æ•°å°±æ˜¯ä½ åœ¨loaderé‡Œé¢è¿”å›çš„å‚æ•°

ä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡ï¼Ÿ

1. æ•°æ®-é¡µé¢-urlè·¯å¾„ç›¸äº’è€¦åˆ
2. ä¸€äº›æ•°æ®éœ€è¦åœ¨è·¯ç”±åŒ¹é…ï¼ŒåŠ è½½ç»„ä»¶ä¹‹å‰è·å¾—ï¼Œç„¶åäº¤ç»™è·¯ç”±æ‰€è¦æ¸²æŸ“çš„ç»„ä»¶
3. loaderæ„ä¸ºï¼Œloaderç»„ä»¶ä¹‹å‰ï¼Œä½ è¦è¿›è¡Œçš„æ‰€æœ‰æ“ä½œ
4. useLoaderData APIå°±æ˜¯å°†ä½ åœ¨loaderæ‰§è¡Œå®Œä¹‹åè¿”å›çš„æ•°æ®å†ä¼ é€’ç»™äº†ç»„ä»¶å†…éƒ¨

**Add a loader to the contact page and access data with `useLoaderData`**

```react
import { Form, useLoaderData } from "react-router-dom";
import { getContact } from "../contacts";

export async function loader({ params }) {
  const contact = await getContact(params.contactId);
  return { contact };
}

export default function Contact() {
  const { contact } = useLoaderData();
  // existing code
}
```

ğŸ‘‰ **Configure the loader on the route**

```react
/* existing code */
import Contact, {
  loader as contactLoader,
} from "./routes/contact";

const router = createBrowserRouter([
  {
    path: "/",
    element: <Root />,
    errorElement: <ErrorPage />,
    loader: rootLoader,
    action: rootAction,
    children: [
      {
        path: "contacts/:contactId",
        element: <Contact />,
        loader: contactLoader,
      },
    ],
  },
]);

/* existing code */
```

## å°è£…ä¸€ä¸ªaxiosæ¥è¯·æ±‚æœåŠ¡å™¨ç«¯çš„æ¥å£æ•°æ®

## æ–‡ç« çš„å†…å®¹æ€ä¹ˆæ˜¾ç¤ºçš„ï¼Ÿï¼Ÿï¼Ÿï¼Ÿmarkdownæ–‡æ¡£æ˜¯æ€ä¹ˆè¢«è½¬æ¢ä¸ºé¡µé¢ä¸Šçš„å…ƒç´ çš„ï¼Œæ˜é‡‘ä¸ºä»€ä¹ˆå¯ä»¥é‚£ä¹ˆå†™ï¼Ÿ

SVGå…ƒç´ æ€ä¹ˆä½¿ç”¨ï¼Œpathæ€ä¹ˆæ ¹æ®è·¯å¾„ç»˜åˆ¶å‡ºåˆé€‚çš„å½¢çŠ¶ï¼Ÿ



## ç»„ä»¶åµŒå¥—ä¸åœ¨çˆ¶å­ï¼Œå¾ˆæ·±ï¼Œç‚¹å‡»ç«‹å³ç™»å½•æ˜¾ç¤ºç™»é™†æ³¨å†Œç»„ä»¶çš„æ—¶å€™ç”¨PubSubä¼ é€’æ¶ˆæ¯



## Reactåœ¨formé‡Œé¢å†™ä¸œè¥¿é¡µé¢è·³è½¬å’Œå‘é€è¯·æ±‚çš„é—®é¢˜

ç”¨Form

ajaxè¯·æ±‚çš„æ ¼å¼ï¼Œä¸ç„¶ä¼šä¸è¢«è¯†åˆ«ä»è€ŒæŠ›å‡ºé”™è¯¯----ä¸ºä»€ä¹ˆï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ

```
xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8')
```

## AXIOSæºç é‡Œé¢è¯·æ±‚æ‹¦æˆªå™¨æ€ä¹ˆå†™çš„



## ç¼–ç¨‹å¼è·¯ç”±å¯¼èˆª

http://www.reactrouter.cn/docs/getting-started/tutorial#%E4%BB%A5%E7%BC%96%E7%A8%8B%E6%96%B9%E5%BC%8F%E5%AF%BC%E8%88%AA

å®˜æ–¹æ¨èç”¨redirect

## ç–‘é—®ï¼šä¸ªäººä¸­å¿ƒçš„userInfoæ€ä¹ˆåœ¨æ–‡ç« å‘è¡¨ç»„ä»¶é‡Œé¢ç‚¹å‡»ä¸€æ¬¡ä¹‹åä¼ é€’åˆ°æ–‡ç« å‘è¡¨ç»„ä»¶

ç”¨PubSubä¼ é€’çš„æ—¶å€™å­˜åœ¨ç”¨æˆ·åˆæ¬¡ç™»å½•å‘è¡¨ä¸æˆåŠŸçš„é—®é¢˜ï¼Œå°±æ˜¯æ‰“å°çš„æ—¶å€™å¾—åˆ°çš„ç”¨æˆ·ä¿¡æ¯å¹¶ä¸æ˜¯å®æ—¶åŒæ­¥çš„ï¼Œä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºåé¢çš„ç»„ä»¶è¿˜æ²¡æŒ‚è½½ä¸Šå»ï¼Œå› ä¸ºå±äºä¸åŒçš„è·¯ç”±ï¼Œåé¢çš„ç»„ä»¶è¿˜æ²¡æœ‰è®¢é˜…è¿™ä¸ªæ¶ˆæ¯ï¼Œå‰é¢çš„ç»„ä»¶å°±å·²ç»å‘å¸ƒå®Œäº†æ‰€æœ‰çš„æ¶ˆæ¯ã€‚

è§£å†³---è¿˜æ˜¯ç”¨contextï¼ŒæŠŠç”¨æˆ·çš„ç™»å½•ä¿¡æ¯æå‡åˆ°æœ€ä¸Šå±‚çš„ç»„ä»¶ï¼Œä»»æ„è·¯ç”±éƒ½èƒ½è®¿é—®åˆ°ã€‚

## ---è¿˜æœ‰å…¨å±€è¯·æ±‚æ‹¦æˆªå™¨ï¼Œé‚£æ ·å†™ä¸è¡Œï¼Œtokenåœ¨æœ‰æ—¶å€™è¿˜æ˜¯å¸¦ä¸ä¸Šï¼Œè¿˜æ˜¯éœ€è¦çœ‹axioså…¨å±€è¯·æ±‚æ‹¦æˆªå™¨æ€ä¹ˆå†™çš„

é‚£æ ·å†™å¸¦çš„tokenæ˜¯æ— æ•ˆçš„ï¼Œæˆ–è€…æœ‰å¯èƒ½å¤šäº†å…¶ä»–è¯·æ±‚å¤´ï¼Œå¯¼è‡´è®¤è¯å¤±è´¥

## é‡è¦ï¼ï¼ä»¥å‰æ²¡é‡åˆ°è¿‡ã€‚ç–‘é—®ï¼šæ€ä¹ˆè®©ç‚¹å‡»æŒ‰é’®å‘é€Ajaxè¯·æ±‚æ’åœ¨inputå¤±å»ç„¦ç‚¹ä¹‹å‰è§¦å‘

1. åŠ ä¸€ä¸ªå®šæ—¶å™¨å»¶è¿Ÿæ‰§è¡Œæ ·å¼å˜åŒ–æ•ˆæœ

2. æ­£å¼ç‰ˆè§£å†³æ–¹æ¡ˆï¼š

   å½“æˆ‘ä»¬ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™ï¼Œæ–‡æœ¬æ¡†å¤±ç„¦ï¼Œè¿™æ˜¯æµè§ˆå™¨çš„é»˜è®¤äº‹ä»¶ã€‚å½“ä½ ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™ï¼Œä¼šè§¦å‘æŒ‰é’®çš„**touchstart/mousedown**äº‹ä»¶ï¼Œ**touchstart/mousedownäº‹ä»¶çš„é»˜è®¤è¡Œä¸ºæ˜¯ä½¿é™¤äº†ä½ ç‚¹å‡»çš„å¯¹è±¡ä¹‹å¤–çš„æœ‰ç„¦ç‚¹çš„å¯¹è±¡å¤±å»ç„¦ç‚¹**ã€‚æ‰€ä»¥**åªè¦åœ¨ä½ ä¸æƒ³è§¦å‘å¤±å»ç„¦ç‚¹äº‹ä»¶çš„é‚£ä¸ªå…ƒç´ ä¸Šé¢**çš„touchstart/mousedownäº‹ä»¶ä¸­é˜»æ­¢é»˜è®¤äº‹ä»¶å‘ç”Ÿå°±å¯ä»¥äº†ï¼

   ```
   onMouseDown={(event) => { event.preventDefault() }}
   ```


## é‡ç‚¹ï¼šä¸‹æ‹‰èœå•çš„å®ç°ï¼š

Node.prototype.contains()

`contains`æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°èŠ‚ç‚¹æ˜¯å¦æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ä¹‹ä¸€ã€‚

- å‚æ•°èŠ‚ç‚¹ä¸ºå½“å‰èŠ‚ç‚¹ã€‚
- å‚æ•°èŠ‚ç‚¹ä¸ºå½“å‰èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ã€‚
- å‚æ•°èŠ‚ç‚¹ä¸ºå½“å‰èŠ‚ç‚¹çš„åä»£èŠ‚ç‚¹ã€‚

ç›‘å¬äº‹ä»¶ï¼Œæ’é™¤å¦‚æœä¸æ˜¯åœ¨å½“å‰èŠ‚ç‚¹ä¸‹é¢è§¦å‘å°±éšè—ï¼Ÿ

----ç»™Documentæ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œå¦‚æœå½“å‰ç»„ä»¶çš„é¡¶å±‚DOMä¸åŒ…å«è§¦å‘äº‹ä»¶èŠ‚ç‚¹çš„DOMå°±è¯´æ˜ç‚¹å‡»äº†è¿™ä¸ªDOMå¤–é¢ï¼Œè®©å…ƒç´ éšè—å°±å¯ä»¥äº†

```react
import React, { useEffect, useRef } from 'react'
import './index.css'
import useNotifacationList from '../../../../useHooks/headerImgMemberNotifacation'

export default function HeaderMenuDown({ homeMenuList }) {
  const menu = useRef()
  /* é¼ æ ‡ç‚¹å‡»æ§åˆ¶ä¸‹æ‹‰èœå•çš„æ˜¾ç¤ºä¸éšè— */
  const { isDisplay, display, noDisplay } = useNotifacationList()

  const changeDisplay = () => {
    if (isDisplay) {
      noDisplay()
    } else {
      display()
    }
  }

  useEffect(() => {
    document.addEventListener('click', (event) => {
      /* åªè¦å½“å‰ç»„ä»¶é‡Œé¢æœ€å¤§çš„ç›’å­ä¸åŒ…å«è§¦å‘äº‹ä»¶çš„é‚£ä¸ªèŠ‚ç‚¹ï¼Œå°±è¯´æ˜é¼ æ ‡ç‚¹å‡»çš„æ˜¯ç›’å­å¤–é¢ */
      if (!menu.current.contains(event.target)) {
        noDisplay()
      }
    })
  }, [])
  return (
    <div
      className='headerMenuDown__div--container'
      ref={menu}
    >
      <div
        className='headerMenuDown__div--center'
        onClick={changeDisplay}
      ><span>é¦–é¡µ</span>
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"
          className={isDisplay ? 'headerMenuDown__svg--centerarrowactive' : ''}
        >
          <path d="M2.45025 4.82431C2.17422 4.49957 2.40501 4.00049 2.83122 4.00049H9.16878C9.59498 4.00049 9.82578 4.49957 9.54975 4.82431L6.38097 8.55229C6.1813 8.78719 5.8187 8.78719 5.61903 8.55229L2.45025 4.82431Z"
            className={isDisplay ? 'headerMenuDown__path--centerarrowactive' : ''}
          ></path></svg>
      </div>
      <ul
        className={'headerMenuDown__ul--absolute ' + (isDisplay ? 'headerMenuDown__ul--display' : '')}
      >
        {homeMenuList.map((item) => {
          return <li key={item.id}><a href="/">{item.title}</a></li>
        })}
      </ul>
    </div>
  )
}

```

## overflow----CSS

## é‡ç‚¹ï¼šæ€ä¹ˆåœ¨flexå¸ƒå±€ä¸‹é¢å¼€å¯æ°´å¹³æ»šåŠ¨æ¡ï¼š

- flex çš„containerå¼€å¯flexï¼Œé»˜è®¤å®½åº¦å°±æ˜¯å±å¹•çš„100%
- flexçš„æ‰€æœ‰å­å…ƒç´ æ·»åŠ `flex-shrink: 0;`è¡¨ç¤ºç©ºé—´ä¸è¶³çš„æ—¶å€™æ¯ä¸ªå­ç›’å­éƒ½ä¸ç¼©å°ï¼Œè¿™æ ·æ‰€æœ‰çš„å­ç›’å­éƒ½ä¼šå ä¸€è¡Œ
- containeræ·»åŠ `overflow-x: auto`å°±ä¼šæ˜¾ç¤ºæ»šåŠ¨æ¡

## ç–‘é—®ï¼šdisplayï¼šnoneé…åˆåŠ¨ç”»æ€ä¹ˆå®ç°

ä¿®æ”¹æ»šåŠ¨æ¡çš„æ ·å¼ï¼š

```
-webkit-scrollbar â€‹æ»šåŠ¨æ¡æ•´ä½“éƒ¨åˆ†
â€‹-webkit-scrollbar-buttonâ€‹ æ»šåŠ¨æ¡ä¸¤ç«¯çš„æŒ‰é’®
â€‹-webkit-scrollbar-track â€‹å¤–å±‚è½¨é“
â€‹-webkit-scrollbar-track-pieceâ€‹ å†…å±‚è½¨é“ï¼Œæ»šåŠ¨æ¡ä¸­é—´éƒ¨åˆ†ï¼ˆé™¤å»ï¼‰
â€‹-webkit-scrollbar-thumbâ€‹ å†…åµŒæ»‘å—
â€‹-webkit-scrollbar-cornerâ€‹ è¾¹è§’
â€‹-webkit-resizer â€‹å®šä¹‰å³ä¸‹è§’æ‹–åŠ¨å—çš„æ ·å¼

```

## æ€ä¹ˆå®ç°å‚ç›´æ–¹å‘çš„æ»šåŠ¨æ¡ï¼Ÿ

- æƒ³æ³•1ï¼Œå’Œæ°´å¹³æ–¹å‘ä¸€è‡´ï¼Œç”¨flexï¼Œå¹¶ä¸”ç¦æ­¢å­å…ƒç´ ç¼©å°

  ```
  /* å±•ç¤ºæ»šåŠ¨æ¡ */
  .creatorLeft__ul--overflowauto {
    display: flex;
    flex-direction: column;
    overflow-y: auto;
  }
  
  .son{
      flex-shrink: 0;
  }
  ```

- åˆ©ç”¨flexçš„å­å…ƒç´ ï¼Œå…¶é«˜åº¦/å®½åº¦æ°¸è¿œä¸ä¼šè¶…å‡ºå±å¹•---è¿™ä¸ªå¯¹çºµå‘æ˜¯æ— æ•ˆçš„

```
son {
    flex: 1;
    height: calc(100% - 100px);
    overflow: auto;
}
```

è¿™æ—¶å€™æœ‰ä¸ªé—®é¢˜ï¼Œçºµå‘å±å¹•ç¼©å°çš„æ—¶å€™å¯è§†åŒºåŸŸä¼šè¢«æµè§ˆå™¨é®æŒ¡ï¼Œæ‰€ä»¥è¿™ä¹ˆè§£å†³ï¼š

åœ¨æ ·å¼ä¸­ï¼Œæˆ‘é‡‡ç”¨äº†å¼¹æ€§å¸ƒå±€display: flexæ¥åšåˆ†å±ã€‚å¯¹äºå¦‚ä½•è‡ªåŠ¨å¡«å……é«˜åº¦ï¼Œç¨ç¨æœ‰äº›éº»çƒ¦ï¼Œä¸è¿‡æœ€åé€šè¿‡100vhè§£å†³äº†ã€‚vhè¿™ä¸ªå•ä½å…¶å®æ˜¯æµè§ˆå™¨è§†é‡ä¸­é«˜åº¦çš„ç™¾åˆ†æ¯”å•ä½ã€‚å‡è®¾æµè§ˆå™¨å±å¹•é«˜åº¦ä¸º640pxï¼Œ1vhå°±ä»£è¡¨6.4pxã€‚å› æ­¤ï¼Œé¡¶éƒ¨é«˜åº¦50pxï¼Œåº•éƒ¨é«˜åº¦50pxï¼Œä¸­é—´çš„é«˜åº¦è®¾ç½®ä¸ºheight: calc(100% - 100px)å°±èƒ½è®©ä¸­é—´éƒ¨åˆ†å¡«æ»¡å±å¹•é«˜åº¦äº†ã€‚

```css
height: calc(100vh - 100px)
```



## å¤´éƒ¨åŒºåŸŸï¼Œæœ‰æ—¶å€™è¦å›ºå®šå®šä½ï¼Œæœ‰æ—¶å€™åˆè¦åœ¨è·¯ç”±ä¸Šå›ºå®šä½ï¼Œåˆ°åº•æ€ä¹ˆå†³å®šï¼Ÿ

å…³äº`Svelte`,`https://zhuanlan.zhihu.com/p/97825481`

ä»£ç ç¼–å†™ç•Œé¢å®ç°ç”¨bytemdæ’ä»¶

## æ³¨æ„ï¼šä¸‹æ‹‰èœå•ç»„ä»¶å®ç°çš„æ—¶å€™ï¼Œéœ€è¦documentç›‘å¬clickäº‹ä»¶éšè—ä¸‹æ‹‰èœå•ï¼Œç”¨åˆ°çš„refèŠ‚ç‚¹æ˜¯åŒ…è£¹ç€buttonæŒ‰é’®å’Œä¸‹æ‹‰èœå•ä¸¤è€…çš„èŠ‚ç‚¹ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯containsçš„æ—¶å€™å¾—åˆ°æ­£ç¡®çš„ç»“æœï¼Œåˆšåˆšå‡ºé”™åœ¨æŠŠmenuèŠ‚ç‚¹åªç»‘å®šåœ¨äº†ä¸‹æ‹‰èœå•é‚£ä¸ªå¤§ç›’å­ä¸Šé¢ã€‚

## ä¸‹æ‹‰ä¸‰è§’çš„å®ç°ï¼šä¸€ä¸ªç™½è‰²çš„ç›’å­ä¸Šä¸‰è§’ç›–ä½å¦å¤–ä¸€ä¸ªç°è‰²çš„ç›’å­ä¸Šä¸‰è§’ï¼Œéƒ½ç”¨ç»å¯¹å®šä½

## ä¸ºä»€ä¹ˆç¬¬ä¸€æ¬¡æ‹¿ä¸åˆ°userInfoçš„contextä¿¡æ¯ï¼Œç¬¬äºŒæ¬¡ç‚¹å‡»è§¦å‘è¿™ä¸ªå‡½æ•°çš„æ—¶å€™å°±èƒ½æ‹¿åˆ°äº†

```react
  const publish = async () => {
    const { userName: author, id: userId } = userInfo
    /* è¿™é‡Œç¡®ä¿æ‹¿åˆ°ç”¨æˆ·åå’Œidä¹‹åå†ä¸Šä¼ ä¿¡æ¯ */
    setArticalInfo({ ...articalInfo, author: userInfo, userId: userInfo })
    console.log(articalInfo)
    console.log(userInfo)
    /*     const res = await reqPublishArtical({
          title,
          content,
          author: userName,
          time: (new Date()).toLocaleString(),
          reading: 0,
          classification: 'åç«¯ å‰ç«¯ js java',
          lesscontent: 'å‰ç«¯ä¹‹è·¯',
          imgUrl: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a2c68eed94124e9faeaabc8602fd6c07~tplv-k3u1fbpfcp-no-mark:240:240:240:160.awebp?',
          imgalt: 'å‰ç«¯',
          authorHeaderImg: 'https://p3-passport.byteimg.com/img/user-avatar/29691c255dda6a7de9a4e6fb6f5724eb~100x100.awebp',
          userId
        })
        if (res.code === 200) {
          console.log('å‘è¡¨æˆåŠŸï¼Œè·³è½¬åˆ°ä¸ªäººä¸­å¿ƒå·²å‘è¡¨æ–‡ç« çš„ç•Œé¢', res)
        } else {
          console.log('code!==200', res)
        } */
  }
```

è¿™æ ·æƒ³ï¼šæ•°æ®ç¡®å®æ˜¯ä¿®æ”¹äº†ï¼Œä½†æ˜¯ä¸èƒ½åœ¨å½“å‰å‡½æ•°é‡Œé¢é©¬ä¸Šçœ‹åˆ°ä¿®æ”¹çš„æ•°æ®ï¼Œéœ€è¦ä¸‹ä¸€æ¬¡æ‰èƒ½çœ‹åˆ°

```
    const { userName: author, id: userId } = userInfo
    /* è¿™é‡Œç¡®ä¿æ‹¿åˆ°ç”¨æˆ·åå’Œidä¹‹åå†ä¸Šä¼ ä¿¡æ¯ */
    console.log({
      ...articalInfo,
      author,
      userId
    })
```

æ‰€ä»¥æƒ³è¦å‘é€æœ€æ–°çš„æ•°æ®ç›´æ¥å±•å¼€å¯¹è±¡æ¥å‘

useStateä¼ å…¥çš„userInfoçš„å€¼ï¼ŒuserInfoå€¼å˜åŒ–äº†ï¼Œå“åº”å¼æ•°æ®çš„å€¼ä¹Ÿä¸ä¼šå˜åŒ–ï¼Œå› ä¸ºè¿™ä¸¤è€…å¹¶æ²¡æœ‰æ‰€è°“çš„ä¾èµ–å…³ç³»ï¼Œè¿™ç§å…³ç³»åªæœ‰åœ¨Vueçš„è®¡ç®—å±æ€§é‡Œé¢æ‰æ˜¯æœ‰çš„

## æ³¨æ„ä¸è¦æŠŠVueçš„è®¡ç®—å±æ€§ç‰¹ç‚¹æ··æ·†åœ¨è¿™é‡Œ

## ç”¨æˆ·åˆ°åº•æ˜¯æ‹¿ä»€ä¹ˆè¯·æ±‚æ•°æ®ï¼Ÿ

/* å†™ä¸€ä¸ªloaderï¼Œè·³è½¬åˆ°å½“å‰é¡µé¢çš„æ—¶å€™ï¼Œå°±æ‹¿ç€ç”¨æˆ·çš„idå»åå°æ‹¿æ•°æ®----å¥½åƒæ‹¿ç€ç”¨æˆ·çš„emailå»æ‹¿æ•°æ®æ›´åˆç†ï¼Œè¿™æ ·ç”¨æˆ·åœ¨å–æ¶ˆç™»å½•ç¬¬äºŒæ¬¡ç™»å½•ç”¨æˆ·åå˜äº†ä¹‹åæ‹¿åˆ°çš„idå°±æ˜¯ä¸ä¸€æ ·çš„ï¼Œå²‚ä¸æ˜¯æ‹¿ä¸åˆ°ä¹‹å‰çš„ä¿¡æ¯äº†ï¼Ÿ */

## åä»£é€‰æ‹©å™¨

å¿…é¡»åŠ åˆ°liæ‰ä¼šèµ·ä½œç”¨ï¼Œè¡¨ç¤ºä¸€ç»„åä»£ä¸­çš„ç¬¬ä¸€ä¸ª

```
.personalhomepagefollow__ul--collection>li:first-child {
  border-top: 1px solid #ccc;
}
```

## React-routerçš„actionå’Œloaderé…åˆæœ‰ä»€ä¹ˆç”¨ï¼Ÿ

1. loaderåœ¨æ¯æ¬¡è·¯ç”±åŒ¹é…æˆåŠŸä»¥åæ‰§è¡Œï¼Œæ‰§è¡Œå®Œå†æ‰§è¡Œrenderï¼Œrederé‡Œé¢é€šè¿‡useLoaderDataæ‹¿åˆ°loader returnçš„æ•°æ®

   - åœºæ™¯ï¼šæ¯æ¬¡è·³è½¬åˆ°ä¸€ä¸ªæ–°çš„é¡µé¢ï¼Œé€šè¿‡paramså‚æ•°ï¼Œqueryå‚æ•°æˆ–è€…stateå‚æ•°æºå¸¦äº†ä»€ä¹ˆæ•°æ®ï¼Œå¹¶ä¸”éœ€è¦æ‹¿ç€è¿™ä¸ªæ•°æ®å»è¯·æ±‚æœåŠ¡å™¨æ‹¿åˆ°å“åº”ï¼Œå†æ ¹æ®å“åº”æ¸²æŸ“æ•°æ®ï¼Œä¹‹å‰çš„å†™æ³•å¯èƒ½å°±æ˜¯useEffecté‡Œé¢è°ƒç”¨å‡½æ•°æ¸²æŸ“useStateçš„æ•°æ®ï¼Œä½†æ˜¯ç°åœ¨åªè¦loaderå°±æå®šäº†

2. actionçš„ä½œç”¨

   - This is where the "old school web" programming model shows up. As we discussed earlier, [``](https://reactrouter.com/en/main/components/form) prevents the browser from sending the request to the server and sends it to your route `action` instead. In web semantics, a POST usually means some data is changing. By convention, React Router uses this as a hint to automatically revalidate the data on the page after the action finishes. That means all of your `useLoaderData` hooks update and the UI stays in sync with your data automatically! Pretty cool.

   - è§£é‡Šï¼šactionå’ŒFormé…åˆä½¿ç”¨ï¼Œåªè¦Formæäº¤ä¹‹åï¼Œactionå°±ä¼šæ‹¦æˆªè¿™ä¸ªè¡Œä¸ºï¼Œå‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œä¹‹åæ‰€æœ‰åœ¨actionè¿™ä¸ªè·¯ç”±é‡Œé¢çš„loaderéƒ½ä¼šé‡æ–°æ‰§è¡Œä¸€éï¼Œä»¥æ‹¿åˆ°å¯èƒ½å› ä¸ºactionå‘èµ·è¯·æ±‚è€Œå¯¼è‡´çš„æ•°æ®çš„æœ€æ–°å˜åŒ–ã€‚

   - ä½†æ˜¯actionæ€ä¹ˆä½¿ç”¨å‘¢ï¼Ÿ

     ```react
     export const action = async ({ request, params }) => {
       // console.log('action', data)
         const formData = await request.formData();
         console.log(Object.prototype.toString.call(formData)) // [object FormData]
         console.log(Object.fromEntries(formData))  
         // Object.fromEntries()æ–¹æ³•æ˜¯Object.entries()çš„é€†æ“ä½œï¼Œç”¨äºå°†ä¸€ä¸ªé”®å€¼å¯¹æ•°ç»„è½¬ä¸ºå¯¹è±¡ã€‚
         return null
     }
     
     <Form method="post">
       <input type="text" name='æ ‡é¢˜' defaultValue={123} />
       <button
         type='submit'
         className='editorheader__btn--bgc'
       // onClick={publish}
       >ç¡®å®šå¹¶å‘å¸ƒ</button>
     </Form>
     
     // å¦‚æ­¤ä¸€æ¥ï¼Œ
     console.log(Object.fromEntries(formData))  // {æ ‡é¢˜: '123'}
     // ç„¶åç»™ä½ éœ€è¦å‘è¯·æ±‚çš„ç½‘å€å¸¦ç€æ•°æ®å‘è¯·æ±‚å°±å¯ä»¥äº†
     ```

     **`FormData`** æ¥å£æä¾›äº†ä¸€ç§è¡¨ç¤ºè¡¨å•æ•°æ®çš„é”®å€¼å¯¹ `key/value` çš„æ„é€ æ–¹å¼ï¼Œå¹¶ä¸”å¯ä»¥è½»æ¾çš„å°†æ•°æ®é€šè¿‡[`XMLHttpRequest.send()`](https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/send) æ–¹æ³•å‘é€å‡ºå»ï¼Œæœ¬æ¥å£å’Œæ­¤æ–¹æ³•éƒ½ç›¸å½“ç®€å•ç›´æ¥ã€‚å¦‚æœé€å‡ºæ—¶çš„ç¼–ç ç±»å‹è¢«è®¾ä¸º `"multipart/form-data"`ï¼Œå®ƒä¼šä½¿ç”¨å’Œè¡¨å•ä¸€æ ·çš„æ ¼å¼ã€‚

   - `redirect`åœ¨æ™®é€šå‡½æ•°ä¸­æ²¡åŠæ³•ç”¨ï¼Œåœ¨loaderä¸­å¯ä»¥ç”¨

## textareaç¦æ­¢è°ƒæ•´å¤§å°

```
resize: none
```

## actioné…åˆloader

1. ä¿®æ”¹ç”¨æˆ·æ•°æ®çš„æ—¶å€™ï¼Œä½¿ç”¨Formï¼Œé…åˆactioné€šçŸ¥åå°æ¥å£ä¿®æ”¹ï¼›
2. ä¿®æ”¹æˆåŠŸä¹‹åè·³è½¬åˆ°é¦–é¡µï¼ŒæŒ‰ç†è¯´è¦è·³è½¬åˆ°user/idï¼Œä½†æ˜¯actionæ€ä¹ˆæ‹¿åˆ°idæ•°æ®å‘¢ï¼Ÿ
3. è·³è½¬åˆ°é¦–é¡µï¼Œè‚¯å®šè¦æœ‰é‡æ–°è¯·æ±‚æœåŠ¡å™¨æœ€æ–°ä¸ªäººæ•°æ®çš„è¿‡ç¨‹ï¼Œè¿™æ—¶å€™æ³¨æ„ï¼Œä¹‹å‰ä¸ªäººä¸­å¿ƒçš„useEffectæ²¡æœ‰å¸è½½å’Œé‡æ–°åŠ è½½çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥useEffectä¸ä¼šé‡æ–°æ‰§è¡Œï¼Œæ‰€ä»¥éœ€è¦å°†ä¸ªäººä¸­å¿ƒè·å–æ•°æ®çš„useEffectå†™ä¸ºloader

## æ³¨æ„ï¼ï¼ï¼ï¼åœ¨renderå‡½æ•°é‡Œé¢åƒä¸‡ä¸è¦ç›´æ¥è°ƒç”¨setXXXï¼Œä¼šé€ æˆç»„ä»¶æ— é™åˆ¶æ¸²æŸ“

å¦‚æœå†³å®šæ•°æ®äº¤ç»™loaderå›æ¥çš„çŠ¶æ€æ¥ç®¡ç†å’Œä¼ é€’ï¼Œé‚£ä¹ˆï¼Œæ‰€æœ‰å‘åå°ä¿®æ”¹æ•°æ®çš„æ–¹å¼éƒ½è¦æ”¹ä¸ºactionï¼Œè¿™æ‰ä¼šè¢«loaderæ£€æµ‹åˆ°

æ³¨å†Œå’Œç™»å½•çš„é¡µé¢ä¹Ÿè¦æ”¹ä¸ºactionçš„å½¢å¼

## ç–‘é—®ï¼šå¦‚æœæˆ‘æƒ³åœ¨actionå‘ä¸€ä¸ªè¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚çš„å‚æ•°ä¸æ­¢æ˜¯Formè¡¨å•é‡Œé¢çš„ï¼Œè¿˜æœ‰å…¶ä»–å‚æ•°æ€ä¹ˆè·å–ï¼Ÿæ¯”å¦‚urlçš„paramså‚æ•°

å¯ä»¥ç”¨submitåŒ…è£…ä¸ºä¸€ä¸ªFormæ ¼å¼çš„æ•°æ®ï¼Œå†ç”¨request.formData()æ¥è·å–æ•°æ®ï¼Œå‘é€è¯·æ±‚

```
  /* å’Œç™»å½•å…¬ç”¨ä¸€ä¸ªactionï¼Œæ‰€ä»¥éœ€è¦åˆ¤æ–­ç±»å‹ */
  /* å› ä¸ºåªè¦è§¦å‘äº†actionå°±ä¼šè®©æ‰€æœ‰çš„loaderå†èµ°ä¸€æ¬¡ï¼Œä¸ºäº†è®©æ¯ä¸€ä¸ªç»„ä»¶éƒ½æ‹¿åˆ°æœ€æ–°çš„ç”¨æˆ·æ•°æ®ï¼Œæ‰€ä»¥æ³¨å†Œå’Œç™»å½•éƒ½è¦èµ°action */
  /* å› ä¸ºç™»å½•çš„æ—¶å€™è¿˜è¦ä¿®æ”¹ç»„ä»¶çš„æ˜¾ç¤ºçŠ¶æ€ï¼Œæ‰€ä»¥è¯·æ±‚åœ¨ç»„ä»¶è‡ªèº«å‘å‡ºï¼Œåªä¸è¿‡è§¦å‘äº†ä¸€ä¸ªåªæœ‰typeçš„action */
  /* actionå°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼šæ ¹æ®submitæˆ–è€…formçš„actionåŒ¹é…å¯¹åº”çš„è·¯å¾„ç„¶åè§¦å‘å¯¹åº”çš„å£°æ˜çš„action */
```

## è¿™ä¸ªäººç¬¬ä¸€æ¬¡ç™»å½•ï¼Œä»¥åç™»å½•çš„idä¸åº”è¯¥å†å˜åŒ–äº†ï¼Œä¸ºä»€ä¹ˆidè¿˜ä¼šå˜ï¼Ÿ

æ•°æ®åº“é‡Œé¢é€€å‡ºç™»å½•çš„æ—¶å€™ä¸èƒ½åˆ é™¤ç”¨æˆ·çš„æ³¨å†Œæˆ–è€…è¯´ä¹‹å‰çš„ä¸€æ¡ç™»å½•ä¿¡æ¯ï¼Œè€Œæ˜¯**å®¢æˆ·ç«¯ç›´æ¥åˆ é™¤è‡ªå·±çš„tokenç„¶åè·³è½¬åˆ°`/`è·¯å¾„å°±å¯ä»¥äº†**

## Appä»¥loaderå½¢å¼è·å–ç”¨æˆ·æ•°æ®çš„æ•ˆç‡é—®é¢˜

å› ä¸ºtokenæ˜¯å†™åœ¨loaderé‡Œé¢çš„ï¼Œæ‰€ä»¥æ¯æ¬¡åªè¦åœ¨ä»»ä½•ä¸€ä¸ªè·¯ç”±ä¸Šé¢å‘äº†actionï¼Œå°±ä¼šé‡æ–°æ‹¿ç€tokenå»loaderæ•°æ®

è¿™æ—¶æ˜¯å¦æœ‰æ•ˆç‡é—®é¢˜ï¼Ÿæ¯”å¦‚å‘è¡¨æ–‡ç« æˆ–è€…æœç´¢æ–‡ç« çš„actionæ ¹æœ¬ä¸éœ€è¦å»é‡æ–°loaderç”¨æˆ·çš„æ•°æ®ã€‚

è¿˜æ˜¯è¯´æœç´¢æ–‡ç« çš„actionå†™é”™äº†ï¼Œæ²¡æœ‰actionåˆ°å…·ä½“çš„è·¯å¾„ï¼Ÿ

## ä¸ºä»€ä¹ˆå‰ç«¯æ‹¿åˆ°çš„JSONæ•°æ®å¯¹è±¡åŒ–ä¹‹åæœ‰/

```
comments
: 
"{\"kakavae\":\"detail\"}"
content
: 
"æµ‹è¯•"
```

## actionDataæ€ä¹ˆä½¿ç”¨

ä¸€ä¸ªäººåªèƒ½ç‚¹èµä¸€æ¬¡ï¼Œè¿”å›201å°±æ˜¯ç‚¹èµé‡å¤

å†ç‚¹ä¸€æ¬¡åº”è¯¥å–æ¶ˆç‚¹èµ



## SVGå­¦ä¹ 

https://www.iconfont.cn/

ä¸Šé¢æœ‰svgå®ä¾‹å¯ä»¥ä¸‹è½½

## ç‚¹å‡»è¯„è®ºä¹‹åé€šè¿‡å“ˆå¸Œè·³è½¬åˆ°é¡µé¢çš„è¯„è®ºä½ç½®

```js
é¡µé¢å†…è·³è½¬åˆ°ç›¸åº”ä½ç½®çš„3ç§æ–¹æ³•

<div class="demo" id="demo">è¿™ä¸ªDIVï¼Œidæ˜¯demo</div>

1.ç¬¬ä¸€ç§æ–¹æ³•ç›´æ¥åœ¨htmlä¸­æ·»åŠ 

<!--1.ä½¿ç”¨aæ ‡ç­¾è·³è½¬åˆ°å¯¹åº”idçš„ä½ç½®-->

<a href="#demo">è·³åˆ°idä¸ºdemoçš„DIV</a>

ã€€ã€€ä½¿ç”¨aæ ‡ç­¾è·³è½¬åˆ°ç›¸åº”idçš„ä½ç½®



2.ç¬¬äºŒç§æ–¹æ³•å…ˆåœ¨htmlä¸­æ·»åŠ 

<!--2.é€šè¿‡btnçš„window.location.hash è·³è½¬åˆ°å¯¹åº”ä½ç½®-->

<input type="button" value="è·³åˆ°idä¸ºdemoçš„DIV" onclick="javascript:onTopClick();" />

ã€€ã€€å†æ·»åŠ jsä»£ç 

function onTopClick() {

window.location.hash = "#domo";

}

ã€€ã€€ç”±äºbtnæ²¡æœ‰herfè·³è½¬åŠŸèƒ½ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨hashï¼ˆé”šé“¾æ¥ï¼‰è·³åˆ°å½“å‰é¡µé¢çš„ä½ç½®



3.ç¬¬ä¸‰ç§æ–¹æ³•å…ˆåœ¨htmlä¸­æ·»åŠ 

<button class="btn"> åˆ°æŒ‡å®šæ»šåŠ¨é«˜åº¦</button>

ã€€ã€€å†æ·»åŠ jsä»£ç 

$(document).on('click',$('.btn'),function(){

$(window).scrollTop($('#demo').offset().top)

})

ã€€ã€€è¿™é‡Œæˆ‘æ˜¯é€šè¿‡å…ˆå¾—åˆ°idä¸ºdemoçš„divè·ç¦»æ–‡æ¡£é¡¶éƒ¨çš„è·ç¦»ï¼Œå†ä½¿é¡µé¢æ»šåŠ¨åˆ°è¿™ä¸ªé«˜åº¦æ¥è¾¾åˆ°ç›®çš„ã€‚
```

ä½†æ˜¯ç¬¬ä¸€ç§æ–¹æ³•ä¸ºä»€ä¹ˆæ²¡æœ‰æ•ˆæœ

æœ€ç»ˆå®ç°ï¼š

```react
  /* ç‚¹å‡»è¯„è®ºåè·³è½¬åˆ°æŒ‡å®šçš„ä½ç½® */
  const commentRef = useRef()
  const turnComment = () => {
    console.log(commentRef.current.offsetTop)
    window.scrollTo(0, commentRef.current.offsetTop)
  }
```

å°†è¿™ä¸¤ä¸ªåˆ†åˆ«äº¤ç»™å­ç»„ä»¶å»æ”¹å˜ï¼Œç‚¹å‡»è¯„è®ºçš„æ—¶å€™è°ƒç”¨ä¸‹é¢çš„å‡½æ•°

ä¸ºä»€ä¹ˆç‚¹å‡»è¿™ä¸ªLinkçš„æ—¶å€™ï¼Œappçš„loaderåˆä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œä¸ç”¨Linkæ·»åŠ hashçš„æ—¶å€™å°±ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ

```react
<Link to={"/post/" + id + '#comment'}>
```

æ¯æ¬¡è·å–åæ¡æ•°æ®ï¼Œé¼ æ ‡æ»šåŠ¨åˆ°æœ€ä¸‹é¢çš„æ—¶å€™å†è·å–10æ¡ï¼Œæ•°æ®åº“æ€ä¹ˆå®ç°ï¼Ÿ

è®©å‰ç«¯æ‹¿ç€ä¸Šä¸€æ¬¡è¯·æ±‚çš„idï¼Œå†å»æ•°æ®åº“é‡Œé¢æ‹¿10æ¡æ•°æ®ï¼Ÿ

## é™åˆ¶æ¯æ¬¡éšæœºè·å–åæ¡æ–‡ç« ä¿¡æ¯

ç°åœ¨é—®é¢˜åœ¨äºï¼Œä½ æ€ä¹ˆé™åˆ¶æ»šåŠ¨çš„åˆ°ä¸€å®šä½ç½®ï¼Œå‘é€ajaxè¯·æ±‚ï¼Œè¯·æ±‚å›æ¥çš„æ•°æ®æ¸²æŸ“åˆ°é¡µé¢ä¸Šä¹‹å‰ï¼Œå…¶ä»–çš„è¯·æ±‚éƒ½æ˜¯æ— æ•ˆçš„ï¼Ÿ

1. `IntersectionObserver`

```js
const getArticalList = async (req, res) => {
  try {
    const count = await dbQuery(`select count(*) as num from artical_content`)

    let startNum = 0
    if (count[0] && count[0].num > 10) {
      startNum = parseInt((count[0].num - 10) * Math.random())
    }

    const result = await dbQuery(`select id, title, author, time, reading, classification, lesscontent, imgurl, imgalt  from artical_content limit ${startNum}, 10`)
    res.send({
      code: 200,
      msg: 'è·å–æ–‡ç« åˆ—è¡¨æˆåŠŸ',
      data: result
    })
  } catch (e) {
    console.log(e)
    res.cc(e)
  }
}
```

```react
ç”¨IntersectionObserveråšå¤ªå¤æ‚äº†ï¼Œæ€ä¹ˆåšä¸å‡ºæ¥
  /* è§‚å¯Ÿæœ€åä¸€ä¸ªæˆ–è€…å€’æ•°ç¬¬ç¬¬10ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœå…¶å‡ºç°åœ¨äº†å±å¹•ä¸­ï¼Œå°±å‘èµ·ajaxè¯·æ±‚ï¼Œå†è¯·æ±‚10ä¸ªæ•°æ® */
  /* å½“articalListPluså˜åŒ–ï¼Œä¹Ÿå°±æ˜¯æ•°æ®æ›´æ–°å›æ¥çš„æ—¶å€™ï¼Œæ ¹æ®æœ€æ–°çš„observeRefå»ºç«‹æ–°çš„è§‚å¯Ÿå¯¹è±¡ */
  const observeRef = useRef()

  const [io] = useState(new IntersectionObserver(async (entries) => {
    /* å‘ä¸Šèµ°çš„æ—¶å€™ä¸èƒ½å†è¯·æ±‚åˆ—è¡¨æ•°æ®äº†ï¼Œä½ æ²¡æœ‰åœ¨ä¹‹å‰çš„ç›‘å¬å™¨ä¸Šç§»é™¤ä¸Šä¸€ä¸ªref */
    if (entries[0].intersectionRatio > 0) {
      /* è·å–æ–°çš„åˆ—è¡¨æ•°æ® */
      const newListData = await getArticleRecommendList()

      /* æ‹¿åˆ°è¿™æ¬¡æ–°çš„åˆ—è¡¨äº†ï¼Œå°±è¦æ›´æ¢ioçš„è§‚å¯Ÿå¯¹è±¡ */
      if (observeRef.current) {
        io.unobserve(observeRef.current)  // æ¯æ¬¡åˆ—è¡¨æ›´æ–°çš„æ—¶å€™ioéƒ½ä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ªï¼Œæ‰€ä»¥æ˜¯æ— æ•ˆç§»é™¤ï¼Œéœ€è¦å°†ioå†™ä¸ºstate
      }

      /* å°†æ–°çš„åˆ—è¡¨æ•°æ®å¤„ç†ä»¥åæ·»åŠ åˆ°å“åº”å¼åˆ—è¡¨ä¸­å†æ¸²æŸ“åˆ°é¡µé¢ä¸Š */
      if (newListData.code === 200) {
        setArticalListPlus([...articalListPlus, ...processArticalList(newListData.data)])
      }
    }
  }))
  /* æ¯æ¬¡åˆ—è¡¨å‘ç”Ÿå˜åŒ–ä¹‹åéƒ½é‡æ–°é€‰æ‹©è§‚å¯Ÿçš„å¯¹è±¡ï¼Œç§»é™¤ä¸Šä¸€æ¬¡è§‚å¯Ÿçš„DOMèŠ‚ç‚¹ï¼Œè§‚å¯Ÿæœ€æ–°çš„DOMèŠ‚ç‚¹ */
  useEffect(() => {
    if (observeRef.current instanceof Object) {
      io.observe(observeRef.current)
    }
    console.log(articalListPlus)
  }, [articalListPlus])
```

```react
ç›‘å¬scrolläº‹ä»¶æ¥åš
/*å½“æ»šåŠ¨åˆ°å¿«è¦åˆ°åº•éƒ¨çš„æ—¶å€™å‘é€ajaxè¯·æ±‚è·å–æ–°çš„æ•°æ®*/
```

2. ç›´æ¥ç›‘å¬scrolläº‹ä»¶ï¼š

```react
  const articalList = useLoaderData()
  const [articalListPlus, setArticalListPlus] = useState([...articalList])

  const addList = throttle(async () => {
    // console.log(window.scrollY, document.body.clientHeight, window.innerHeight)
    /* æ»šä¸Šå»çš„é«˜åº¦ï¼Œæ•´ä¸ªé¡µé¢çš„é«˜åº¦ï¼Œå¯è§†åŒºåŸŸçš„é«˜åº¦ */
    /* å¦‚æœæ•´ä¸ªé¡µé¢çš„é«˜åº¦-æ»šä¸Šå»çš„é«˜åº¦ å’Œ å¯è§†åŒºåŸŸçš„é«˜åº¦å·®ä¸å¤šï¼Œå°±è¯´æ˜æœ‰å¾ˆå¤šå·²ç»è¢«æ»šä¸Šå»äº† */
    if (document.body.clientHeight - window.scrollY < window.innerHeight + 200) {
      /* æ»šä¸‹æ¥çš„æ—¶å€™ä¼šè§¦å‘å¤šæ¬¡ï¼Œå¯¼è‡´å¤šä¸ªè¯·æ±‚ä»»åŠ¡ç§¯æ”’åœ¨ä¸€èµ·ï¼Œå› ä¸ºè¾¾åˆ°ä¸Šé¢çš„æ¡ä»¶åœ¨æ»šåŠ¨è¿‡ç¨‹ä¸­ä¼šæœ‰å¾ˆå¤šæ¬¡ */
      console.log(document.body.clientHeight, window.scrollY, window.innerHeight + 200)
      const newListData = await getArticleRecommendList()
      /* å°†æ–°çš„åˆ—è¡¨æ•°æ®å¤„ç†ä»¥åæ·»åŠ åˆ°å“åº”å¼åˆ—è¡¨ä¸­å†æ¸²æŸ“åˆ°é¡µé¢ä¸Š */
      if (newListData.code === 200) {
        setArticalListPlus([...articalListPlus, ...processArticalList(newListData.data)])
        console.log(articalListPlus)
      }
    }
  }, 100)

  useEffect(() => {
    window.addEventListener('scroll', addList)
  }, [addList])
```

å‡ ä¸ªç‰¹æ®Šå€¼ï¼š

```js
window.innerHeight // å¯è§†èŒƒå›´çš„é«˜åº¦ å³â€œè§†å£â€ï¼ˆviewportï¼‰çš„å¤§å°ï¼ˆå•ä½åƒç´ ï¼‰ã€‚è¿™ä¸¤ä¸ªå±æ€§åªè¯»ã€‚
window.innerWidth

document.body.clientHeight // bodyæ•´ä½“çš„é«˜åº¦,å¯ä»¥è¯´æ˜¯æ–‡æ¡£çš„æ•´ä½“é«˜åº¦
document.body.scrollHeight // bodyæ•´ä½“çš„é«˜åº¦,å¯ä»¥è¯´æ˜¯æ–‡æ¡£çš„æ•´ä½“é«˜åº¦
Element.scrollHeight  // è¿™ä¸ªåªè¯»å±æ€§æ˜¯ä¸€ä¸ªå…ƒç´ å†…å®¹é«˜åº¦çš„åº¦é‡ï¼ŒåŒ…æ‹¬ç”±äºæº¢å‡ºå¯¼è‡´çš„è§†å›¾ä¸­ä¸å¯è§å†…å®¹ã€‚

window.pageXOffsetï¼Œwindow.pageYOffset
window.scrollXï¼Œwindow.scrollY // window.scrollXå±æ€§è¿”å›é¡µé¢çš„æ°´å¹³æ»šåŠ¨è·ç¦»ï¼Œwindow.scrollYå±æ€§è¿”å›é¡µé¢çš„å‚ç›´æ»šåŠ¨è·ç¦»ï¼Œå•ä½éƒ½ä¸ºåƒç´ ã€‚è¿™ä¸¤ä¸ªå±æ€§åªè¯»ã€‚
```

## Reactç›‘å¬äº‹ä»¶æ‰§è¡Œçš„æ–¹æ³•ä¸­å¦‚ä½•è·å–æœ€æ–°çš„state

æ–‡æ¡£æ˜ç¡®è¯´äº†setStateé™¤äº†å¯ä»¥æ¥æ”¶stateçš„æœ€æ–°å€¼å¤–ï¼Œè¿˜å¯ä»¥æ¥æ”¶ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„å‚æ•°æ˜¯æ—§çš„stateï¼Œè¿”å›å€¼ä¸ºæ–°å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™

```javascript
useEffect(() => { 
    // æ·»åŠ äº‹ä»¶ç›‘å¬ 
    document.addEventListener("click", handleClick, true);
    return () => { 
    // ç§»é™¤äº‹ä»¶ç›‘å¬ 
    document.removeEventListener("click", handleClick, true) } 
}, []) 

const handleClick = () => { 
    // æ‰§è¡Œä¸€äº›è¯»å–stateçš„æ“ä½œ 
    console.log(count); 
    setCount(preValue => {
        // æ‰§è¡Œä¸€äº›è¯»å–stateçš„æ“ä½œ 
        console.log(preValue); 
        return preValue+1;
   }); 
}
```

æœ€ç»ˆè§£å†³ï¼š

```react
  /* éœ€è¦å–æ¶ˆç›‘å¬çš„å‡½æ•° */
  const addList = () => {
    window.addEventListener('scroll', async () => {
      /* æ»šä¸Šå»çš„é«˜åº¦ï¼Œæ•´ä¸ªé¡µé¢çš„é«˜åº¦ï¼Œå¯è§†åŒºåŸŸçš„é«˜åº¦ */
      console.log(parseInt(document.body.clientHeight - window.scrollY), window.innerHeight)
      if (parseInt(document.body.clientHeight - window.scrollY) <= window.innerHeight) {
        /* æ»šä¸‹æ¥çš„æ—¶å€™ä¼šè§¦å‘å¤šæ¬¡ï¼Œå¯¼è‡´å¤šä¸ªè¯·æ±‚ä»»åŠ¡ç§¯æ”’åœ¨ä¸€èµ·ï¼Œå› ä¸ºè¾¾åˆ°ä¸Šé¢çš„æ¡ä»¶åœ¨æ»šåŠ¨è¿‡ç¨‹ä¸­ä¼šæœ‰å¾ˆå¤šæ¬¡ */
        const newListData = await getArticleRecommendList()
        if (newListData.code === 200) {
          setArticalListPlus((preValue) => {
            return [...preValue, ...processArticalList(newListData.data)]
          })
        }
      }
    })
    /* ç»„ä»¶å¸è½½çš„æ—¶å€™å–æ¶ˆç›‘å¬ */
    return () => {
      window.removeEventListener('scroll', addList)
    }
  }

  /* ç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼Œå½“æ»šåŠ¨åˆ°è¿˜å‰©200pxçš„æ—¶å€™ï¼Œå°±å¼€å§‹åŠ è½½æ–°çš„åˆ—è¡¨æ•°æ®
  åŠ è½½æ–°çš„åˆ—è¡¨æ•°æ®çš„æ—¶å€™ï¼Œä¸èƒ½å†è¯·æ±‚æ›´æ–°çš„åˆ—è¡¨æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½åŒæ—¶å‘èµ·å¤šä¸ªè¯·æ±‚
  åœ¨æ–°çš„æ•°æ®å›æ¥ï¼Œæ·»åŠ åˆ°é¡µé¢ä¸Šä¹‹å‰ï¼Œscrolléƒ½ä¸èƒ½è§¦å‘è¯·æ±‚æ•°æ®

  æ‹¿ç€ä¸€ä¸ªå˜é‡ï¼Œå¼€å§‹è¯·æ±‚è®¾ä¸ºfalseï¼Œè¿›ä¸å»æ¡ä»¶ï¼Œå½“DOMè¢«æ›´æ–°ä¹‹åæ‰å°†è¿™ä¸ªå˜é‡è®¾ç½®ä¸ºtrueï¼Œå…è®¸scrollå†æ¬¡è§¦å‘äº‹ä»¶
  */

  useEffect(addList, [addList])
```

ä½†æ˜¯æˆ‘è§‰å¾—é‚£ä¸ªå°äºç­‰äºå¦‚æœéœ€è¦ä¸åˆ°è¾¾åº•éƒ¨çš„æ—¶å€™å°±è§¦å‘ï¼Œè¦æ€ä¹ˆåŠï¼Ÿè¿ç»­æ»šåŠ¨çš„æ—¶å€™ï¼Œè¿˜æ˜¯ä¼šå¤šæ¬¡ç»™åå°å‘è¯·æ±‚ã€‚

æ‰€ä»¥å°è¯•ä¸€ä¸‹è§‚å¯Ÿæœ€åä¸€ä¸ªæˆ–è€…å€’æ•°ç¬¬å‡ ä¸ªçš„divçš„ä½ç½®ï¼Œæˆ–è€…å†å°è¯•ä¸€ä¸‹åˆ©ç”¨IntersectionObserverèƒ½ä¸èƒ½åšå‡ºæ¥ï¼Ÿ



## æ›´æ¢å¤´åƒçš„å®ç°è¿‡ç¨‹

1. é€šè¿‡FormDataä¸Šä¼ å›¾ç‰‡æ–‡ä»¶

   ```react
     /* æäº¤å¤´åƒçš„ä¿®æ”¹ä¿¡æ¯ -- è¯¥æ–¹æ³•å’Œè¡¨å•çš„æäº¤ä¼šåŒæ—¶è§¦å‘ï¼Œä¸å½±å“ä¹‹å‰çš„æ¥å£*/
     const publishImg = async () => {
       const imgFile = fileIpt.current.files[0]  // inputåªä¸Šä¼ ä¸€å¼ ç…§ç‰‡ï¼Œè¿™ä¸ªç…§ç‰‡å°±æ˜¯åˆ—è¡¨çš„ç¬¬ä¸€ä¸ª
       const formData = new FormData()
   
       // æ ¼å¼æ ¡éªŒ
       if (!imgFile || !imgFile.type.match('image.*')) {
         alert('è¯·ä¸Šä¼ æ­£ç¡®çš„å›¾ç‰‡æ ¼å¼')
         return
       }
   
       formData.append('headerImg', imgFile, userInfo.id + '_headerImg.' + imgFile.type)
   
       const resData = await changeHeaderAPI(formData)
       console.log(resData)
   
     }
   ```

   ä¸ºä»€ä¹ˆè¦è®¾ç½®FormDataï¼Ÿhtml5æ–°å¢çš„ç‰¹æ€§ï¼Œå¯ä»¥ç›´æ¥ä¼ è¾“æ–‡ä»¶ï¼Œè¯·æ±‚å¤´éœ€è¦è®¾ç½®ä¸º`multipart/form-data`

   xhrå‘é€çš„å°±æ˜¯ä¸€æ•´ä¸ªFormData

   ```
   appendå°±æ˜¯åœ¨ç°æœ‰çš„é”®å€¼ä¸Šé¢å¢åŠ æ–°çš„å€¼ï¼Œsetä¼šæ›¿æ¢æ‰æ—§çš„å€¼
   ```

   ```
   if (data instanceof FormData) {
         xhr.setRequestHeader('Content-Type', 'multipart/form-data')
   xhr.send(data)
   ```

2. åå°æ€ä¹ˆæ‹¿åˆ°å‰å°å‘é€è¿‡æ¥çš„FormDataï¼Œæ€ä¹ˆå¤„ç†FormData?

   è¸©å‘è®°å½•

   ä½¿ç”¨ç°æœ‰çš„åŒ…`formidable`----èƒ½ä¸èƒ½è‡ªå·±å†™ä¸€ä¸ªï¼Ÿ

   - å‰ç«¯ä¼ é€’çš„æ—¶å€™ä¸èƒ½è‡ªå®šä¹‰è¯·æ±‚æŠ•ï¼Œè€Œè¦è®©æµè§ˆå™¨è‡ªå·±å»æ·»åŠ 
   - æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„è¦æ˜¯ä¸€ä¸ªå…¨è·¯å¾„
   - ä¼šç›´æ¥å­˜å‚¨æ–‡ä»¶ï¼Œè€Œä¸æ˜¯è¯»å–ä»¥åå†å­˜å‚¨ï¼Œå­˜å‚¨çš„æ–‡ä»¶åæ˜¯ä¸€ä¸ªéè‡ªå®šä¹‰çš„å­—ç¬¦ä¸²ï¼Œè€Œä¸”æ²¡æœ‰åç¼€å
   - å°†å‰ç«¯ä¼ é€’çš„åç¼€åŠ åˆ°è‡ªå®šä¹‰çš„åç¼€åä¸Šæ‰èƒ½æ­£å¸¸æ˜¾ç¤ºå›¾ç‰‡

   ```js
   // å¼•å…¥å®ç°æ–‡ä»¶ä¸Šä¼ çš„æ¨¡å—
   const { IncomingForm } = require('formidable')
   
   const editUserHeader = async (req, res) => {
     // 1.åˆ›å»ºæ–‡ä»¶ä¸Šä¼ å¯¹è±¡
     let form = new IncomingForm()
     // 2.æ·»åŠ å¿…è¦çš„é…ç½®
     // 2.1 è®¾ç½®ç¼–ç ,formidableä¹Ÿå¯ æ¥æ”¶æ™®é€šé”®å€¼å¯¹ï¼Œè¿™ä¸ªæ—¶å€™å°±æœ‰éœ€è¦è®¾ç½®ç¼–ç ï¼Œå¦‚æœåªæ˜¯ä¸Šä¼ æ–‡ä»¶ï¼Œåˆ™ä¸ç”¨è®¾ç½®
     // form.encoding = 'utf-8'
     // // 2.2 è®¾ç½®ä¸Šä¼ æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ï¼Œä¸€å®šç»™ä¸€ä¸ªå…¨è·¯å¾„ï¼Œå¦åˆ™æŠ¥é”™
     form.uploadDir = path.join(__dirname, '/images')
   
     // // 2.3 è®¾ç½®æ˜¯å¦ä¿ç•™æ–‡ä»¶çš„æ‰©å±•åï¼Œé»˜è®¤ä¸ä¿ç•™
     form.keepExtensions = true
   
     // 3.è°ƒç”¨ä¸Šä¼ æ–¹æ³•,å®ç°æ–‡ä»¶ä¸Šä¼ 
     // form.parse(è¯·æ±‚æŠ¥æ–‡ï¼Œå›è°ƒå‡½æ•°)
     // err:æ–‡ä»¶ä¸Šä¼ å¤±è´¥æ—¶çš„é”™è¯¯ä¿¡æ¯
     // fieldsï¼šæ¥æ”¶åˆ°æ™®é€šé”®å€¼å¯¹--å¯¹è±¡
     // filesï¼šæ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯,ç‰¹åˆ«æ˜¯ä¸Šä¼ æˆåŠŸååœ¨æœåŠ¡å™¨ç«¯çš„ä¿¡æ¯
     form.parse(req, (err, fields, files) => {
       console.log(files)
   
       if (err) {
         console.log(err)
         res.send({
           code: 204,
           msg: 'æ–‡ä»¶ä¸Šä¼ å¤±è´¥',
           err
         })
       } else {
         res.send({
           code: 200,
           msg: 'æ–‡ä»¶ä¸Šä¼ æˆåŠŸ',
           img: path.basename(form.uploadDir)
         })
       }
     })
   }
   ```

   ```js
   /*ä¼˜åŒ–çš„ç‰ˆæœ¬*/
   /* ä¿®æ”¹æ–‡ä»¶åçš„å‡½æ•°ï¼Œå¦‚æœæœ‰é‡åçš„æ–‡ä»¶ï¼Œå°±åˆ é™¤é‚£ä¸ªæ–‡ä»¶ï¼Œå°†ç°åœ¨çš„å‘½åç»§ç»­ */
   const changeFileName = (oldPath, id, end) => {
     const newPath = path.join(__dirname, '/images/', id + '.' + end)
     const imgUrl = SERVER_NAME + '/images/' + id + '.' + end
     return new Promise(async (resolve, reject) => {
       /* 1.å¦‚æœé‡åå°±åˆ é™¤ä¹‹å‰çš„æ–‡ä»¶ */
       let unLinkRes = null
       try {
         if (fs.existsSync(newPath)) {
           unLinkRes = await new Promise((resolve, reject) => {
             fs.unlink(newPath, (err, result) => {
               if (err) {
                 reject({
                   msg: 'æ–‡ä»¶é‡åä¸”åˆ é™¤å¤±è´¥'
                 })
               } else {
                 resolve('åˆ é™¤æˆåŠŸ')
               }
             })
           })
         }
       } catch (e) {
         console.log(e)
       }
   
       /* 2.å¦‚æœåˆ é™¤æˆåŠŸäº† */
       /* æˆ–è€…æ ¹æœ¬æ²¡æœ‰é‡åçš„æƒ…å†µå°±è¿”å›è¯»å–å›¾ç‰‡çš„url */
       fs.rename(oldPath, newPath, (err) => {
         if (err) {
           reject({
             msg: 'æ”¹åå¤±è´¥',
             err
           })
         } else {
           resolve(imgUrl)
         }
       })
   
     })
     /* å¦‚æœé‡åäº†æ€ä¹ˆåŠï¼Ÿ */
     /* åˆ é™¤ä¹‹å‰çš„æ–‡ä»¶ï¼ŒæŠŠæ–°çš„æ–‡ä»¶é‡å‘½å */
   
   }
   
   const editUserHeader = async (req, res) => {
     const { id } = req.auth
     // 1.åˆ›å»ºæ–‡ä»¶ä¸Šä¼ å¯¹è±¡
     let form = new IncomingForm()
     // 2.æ·»åŠ å¿…è¦çš„é…ç½®
     // 2.1 è®¾ç½®ç¼–ç ,formidableä¹Ÿå¯ æ¥æ”¶æ™®é€šé”®å€¼å¯¹ï¼Œè¿™ä¸ªæ—¶å€™å°±æœ‰éœ€è¦è®¾ç½®ç¼–ç ï¼Œå¦‚æœåªæ˜¯ä¸Šä¼ æ–‡ä»¶ï¼Œåˆ™ä¸ç”¨è®¾ç½®
     // form.encoding = 'utf-8'
     // // 2.2 è®¾ç½®ä¸Šä¼ æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ï¼Œä¸€å®šç»™ä¸€ä¸ªå…¨è·¯å¾„ï¼Œå¦åˆ™æŠ¥é”™
     form.uploadDir = path.join(__dirname, '/images')
   
     // // 2.3 è®¾ç½®æ˜¯å¦ä¿ç•™æ–‡ä»¶çš„æ‰©å±•åï¼Œé»˜è®¤ä¸ä¿ç•™
     form.keepExtensions = true
   
     // 3.è°ƒç”¨ä¸Šä¼ æ–¹æ³•,å®ç°æ–‡ä»¶ä¸Šä¼ 
     // form.parse(è¯·æ±‚æŠ¥æ–‡ï¼Œå›è°ƒå‡½æ•°)
     // err:æ–‡ä»¶ä¸Šä¼ å¤±è´¥æ—¶çš„é”™è¯¯ä¿¡æ¯
     // fieldsï¼šæ¥æ”¶åˆ°æ™®é€šé”®å€¼å¯¹--å¯¹è±¡
     // filesï¼šæ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯,ç‰¹åˆ«æ˜¯ä¸Šä¼ æˆåŠŸååœ¨æœåŠ¡å™¨ç«¯çš„ä¿¡æ¯
     const imgUrl = await new Promise((resolve, reject) => {
       form.parse(req, async (err, fields, files) => {
         if (err) {
           console.log(err)
           reject({
             code: 204,
             msg: 'æ–‡ä»¶ä¸Šä¼ å¤±è´¥',
             err
           })
         } else {
           // console.log(files.headerImg.filepath)
           /* æ ¹æ®filesé‡Œé¢çš„ä¿¡æ¯ä¿®æ”¹æ–‡ä»¶å */
           /* æºæ–‡ä»¶ååç¼€ */
           const end = files.headerImg.originalFilename.split('.')[1]
           const newName = path.join(__dirname, '/images/', id + '.' + end)
           // const imgUrl = SERVER_NAME + '/images/' + id + '.' + end
   
           const imgUrl = await changeFileName(files.headerImg.filepath, id, end)
           resolve(imgUrl)
         }
       })
     })
   
   
     // 4.å°†ä¸Šä¼ åå¾—åˆ°çš„å¤´åƒçš„urlå­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„ç”¨æˆ·ä¿¡æ¯è¡¨å½“ä¸­
     const resData = await dbQuery(`update register_user set imgUrl = '${imgUrl}'`)
     res.send({
       code: 200,
       msg: 'æ›´æ¢å¤´åƒæˆåŠŸ',
       img: imgUrl,
       data: resData
     })
   }
   ```

   

















# ä»¥ä¸‹è®°å½•mysqlçš„æ“ä½œ

### è¡¨ä¸­æ’å…¥æ–°çš„å€¼

```mysql
ALTER TABLE `my_db_03`.`artical_content` 
ADD COLUMN `likes` VARCHAR(255) NULL AFTER `authorId`,
ADD COLUMN `comments` TEXT(64) NULL AFTER `likes`;
```

### ç‚¹èµåæ›´æ–°æ–‡ç« è¡¨

```mysql
UPDATE `my_db_03`.`artical_content` SET `likes` = 'å¼ ä¸‰', `comments` = 'å¾ˆèµï¼ï¼ï¼' WHERE (`id` = '09383d32-f8d7-4172-947e-d264d18dcf9f');
```

ç‚¹èµé€»è¾‘å®ç°ï¼š

```js
/* ç‚¹èµæ–‡ç«  */
const likeArtical = async (req, res) => {
  console.log(req.params, req.auth)
  /* ä»tokené‡Œé¢è·å–åˆ°äº†ç”¨æˆ·ç›¸å…³çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå°†è¿™ä¸ªç”¨æˆ·åæ·»åŠ åˆ°æ–‡ç« çš„ç‚¹èµè¡¨å€¼é‡Œé¢ */
  const articalid = req.params.articalid
  const { userName } = req.auth
  /* è®©å‰ç«¯æŠŠä¹‹å‰æ‹¿åˆ°çš„æ‰€æœ‰çš„ç‚¹èµçš„äººçš„åˆ—è¡¨å’Œæœ€æ–°çš„ç‚¹èµä¹Ÿå°±æ˜¯è‡ªå·±çš„userNameä¸€èµ·ä¼ ä¸Šæ¥ï¼Œåœ¨è¿™é‡Œåªéœ€è¦æ›´æ–°ï¼Œå¦åˆ™åˆè¦æŸ¥ä¸€æ¬¡æ•°æ®åº“ */
  try {
    /* 1.å»æ•°æ®åº“æŸ¥æ‰¾æ‰€æœ‰å·²ç»ç‚¹èµçš„äºº */
    let likes = await new Promise((resolve, reject) => {
      db.query(`select likes from artical_content where id = '${articalid}'`, (err, result) => {
        if (err) {
          reject('ç‚¹èµæ’å…¥æ•°æ®åº“å¤±è´¥')
        } else {
          resolve(result)
        }
      })
    })

    /* 2.å¦‚æœå·²ç»ç‚¹èµçš„å’Œä¼ è¿‡æ¥çš„äººç”¨æˆ·åä¸€è‡´ï¼Œå°±æ‹’ç»ç‚¹èµï¼Œè¿”å›ç‚¹èµå¤±è´¥ï¼Œå·²ç»ç‚¹è¿‡äº† */
    if (likes[0]) {
      const likesList = likes[0].likes.split('&')
      for (let item of likesList) {
        if (item === userName) {
          return res.send({
            code: 201,
            msg: 'æ‚¨å·²ç»ç‚¹èµäº†ï¼Œä¸èƒ½å†ç‚¹èµäº†'
          })
        }
      }
    }

/* æœ€ç»ˆå­˜åœ¨æ•°æ®åº“é‡Œé¢çš„userNameä»¥&ç¬¦å·çš„å½¢å¼åˆ†éš”å¼€æ¥ */
    if (likes[0].likes) {
      likes = likes[0].likes + '&'
    } else {
      likes = ''
    }

    const resultData = await new Promise((resolve, reject) => {
      db.query(`update artical_content set likes = '${likes + userName}' where id = '${articalid}'`, (err, result) => {
        if (err) {
          reject('ç‚¹èµæ’å…¥æ•°æ®åº“å¤±è´¥')
        } else {
          resolve(result)
        }
      })
    })
    res.send({
      code: 200,
      msg: 'ç‚¹èµæˆåŠŸ',
      data: resultData
    })
  } catch (e) {
    console.log(e)
  }
}
```

### åŒç†ï¼Œè¯„è®ºåæ›´æ–°è¡¨ï¼š

```js
const commentArtical = async (req, res) => {
  // console.log(req.body)
  const { id: articalid, comment } = req.body
  const { userName } = req.auth
  /* ç›´æ¥åœ¨æ•°æ®åº“ä¸­å­˜JSONåŒ–çš„æ•°æ®ï¼Œå¾—åˆ°çš„è¿”å›å€¼ç›´æ¥è¿”å›ç»™å‰ç«¯ */
  try {
    /* 1.è·å–æ•°æ®åº“ä¸­è¯„è®ºçš„å€¼ */
    const commentsData = await new Promise((resolve, reject) => {
      db.query(`select comments from artical_content where id = '${articalid}'`, (err, result) => {
        if (err) {
          reject('ç‚¹èµæ’å…¥æ•°æ®åº“å¤±è´¥')
        } else {
          resolve(result)
        }
      })
    })

    /* 2.å°†æ–°çš„å€¼æ·»åŠ åˆ°æ—§çš„å€¼ä¸­ */
    let newCommentsList = commentsData[0].comments
    if (newCommentsList) {
      newCommentsList = JSON.stringify({
        ...JSON.parse(newCommentsList),
        [userName]: comment
      })
    } else {
      newCommentsList = JSON.stringify({
        [userName]: comment
      })
    }

    /* 3.æ–°çš„è¯„è®ºæ•°æ®updateåˆ°æ•°æ®åº“ä¸­ */
    const resultData = await new Promise((resolve, reject) => {
      db.query(`update artical_content set comments = '${newCommentsList}' where id = '${articalid}'`, (err, result) => {
        if (err) {
          reject('è¯„è®ºæ’å…¥æ•°æ®åº“å¤±è´¥')
        } else {
          resolve(result)
        }
      })
    })
    res.send({
      code: 200,
      msg: 'è¯„è®ºæˆåŠŸ',
      data: resultData
    })
  } catch (e) {
    console.log(e)
  }
}
```



ç–‘é—®ï¼š

```
æ•°æ®åº“ä¸­å­˜å‚¨çš„å¯¹è±¡æ•°ç»„æ ¼å¼æ‹¿åˆ°å‰å°ä¸ºä»€ä¹ˆå˜æˆè¿™æ ·å­
å¹¶ä¸”è¿˜éœ€è¦æ ¹æ®æ•°ç»„åˆ°åº•æœ‰æ²¡æœ‰å¯¹è±¡æ¥JSON.parse()ï¼Œå¦‚æœä¸è¿™æ ·çš„è¯JSON.parseä¼šæŠ¥é”™ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ
"[{\"kakavae\":\"123\"},{\"kakavae\":\"456\"},{\"kakavae\":\"456789\"}]"
```

åˆ é™¤æŸä¸€åˆ—

```
alter table pins_content drop column time;
```

